openapi: 3.0.0
info:
  title: LOOPy API(테스트)
  description: 루피 프로젝트 백엔드 API 문서입니다
  version: 1.0.0

servers:
  - url: https://loopyxyz.duckdns.org
    description: 서버 배포 도메인 

security:
  - bearerAuth: []

paths:
  /health:
    get:
      summary: 헬스 체크
      description: 서버가 정상 작동 중인지 확인하기 위한 API
      tags:
        - Health
      responses:
        "200":
          description: 서버 작동 정상
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: "null"
                    example: null
                  success:
                    type: string
                    example: 루피 백엔드 작동 중!
  
  /api/v1/users/me/verify-phone:
    post:
      tags:
        - Auth
      summary: 전화번호 인증 완료 통보
      description: 프론트에서 Firebase를 통해 전화번호 인증을 완료한 후, 백엔드에 인증 완료 사실을 알리기 위한 용도의 API입니다. 사용자 식별 없이 성공 응답만 반환합니다.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - phoneNumber
              properties:
                phoneNumber:
                  type: string
                  example: "010-1234-5678"
      responses:
        '200':
          description: 전화번호 인증 완료 확인 응답
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 전화번호 인증 확인됨
                  phoneNumber:
                    type: string
                    example: "010-1234-5678"
        '400':
          description: 잘못된 요청 (phoneNumber 누락)
          content:
            application/json:
              schema:
                type: object
                properties:
                  errorCode:
                    type: string
                    example: BAD_REQUEST
                  reason:
                    type: string
                    example: phoneNumber가 필요합니다.
                  data:
                    type: object
                    nullable: true

    
  /api/v1/auth/signup:
    post:
      summary: 이메일 회원가입
      description: 사용자가 이메일, 비밀번호, 닉네임, 전화번호, 사용자 역할, 알림 수신 동의 및 약관 동의 정보를 제출하여 회원가입
      tags:
        - Auth
      security: [] 
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
            example:
              email: test@example.com
              password: securepassword123
              nickname: 테스터
              phoneNumber: "01012345678"
              role: CUSTOMER
              allowKakaoAlert: true
              agreements:
                termsAgreed: true
                privacyPolicyAgreed: true
                marketingAgreed: false
                locationPermission: true
      responses:
        '201':
          description: 회원가입 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 회원가입 성공
                  token:
                    type: string
                    example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                  user:
                    $ref: '#/components/schemas/UserProfile'
        '400':
          description: 잘못된 요청 (필수 항목 누락 또는 중복된 이메일 등)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/auth/signup:
    post:
      summary: 이메일 회원가입(사장)
      description: 사용자가 이메일, 비밀번호, 닉네임, 전화번호, 사용자 역할, 알림 수신 동의 및 약관 동의 정보를 제출하여 회원가입
      tags:
        - Auth
      security: [] 
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
            example:
              email: test@example.com
              password: securepassword123
              nickname: 테스터
              phoneNumber: "01012345678"
              role: CUSTOMER
              allowKakaoAlert: true
              agreements:
                termsAgreed: true
                privacyPolicyAgreed: true
                marketingAgreed: false
                locationPermission: true
      responses:
        '201':
          description: 회원가입 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 회원가입 성공
                  token:
                    type: string
                    example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                  user:
                    $ref: '#/components/schemas/OwnerProfile'
        '400':
          description: 잘못된 요청 (필수 항목 누락 또는 중복된 이메일 등)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/auth/login:
    post:
      summary: 이메일 로그인
      description: 사용자가 이메일과 비밀번호로 로그인, JWT 토큰과 사용자 정보를 발급
      tags:
        - Auth
      security: [] 
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: 로그인 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 로그인 성공
                  token:
                    type: string
                    example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                  user:
                    $ref: '#/components/schemas/LoginUserProfile'
        '400':
          description: 이메일 또는 비밀번호 오류
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'


  /api/v1/auth/logout:
    post:
      summary: 로그아웃
      description: JWT 토큰을 사용하여 인증된 사용자의 로그아웃 처리
      tags:
        - Auth
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 로그아웃 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 로그아웃 완료
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/users/me/qrcode:
    get:
      summary: 사용자 QR 코드 조회
      description: |
        회원가입 시 자동 생성된 사용자의 QR 코드를 조회합니다.  
        QR 코드는 사용자 ID를 기반으로 생성되며, 값이 변하지 않습니다.
      tags:
        - Users
      security:
        - bearerAuth: []
      responses:
        '200':
          description: QR 코드 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  success:
                    type: object
                    properties:
                      userId:
                        type: integer
                        example: 1
                      qrCodeImage:
                        type: string
                        description: data:image/png;base64 형식의 QR 코드 이미지 문자열
                        example: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADIC...
        '401':
          description: 인증 실패 (토큰 누락 또는 만료)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: QR 코드 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: 서버 내부 오류
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'



  /api/v1/points/current:
    get:
      summary: 현재 포인트 조회
      description: 인증된 사용자의 현재 보유 포인트를 조회
      tags:
        - Point
      security:
        - bearerAuth: []
      responses:
        "200":
          description: 현재 포인트 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: "null"
                    example: null
                  success:
                    type: object
                    properties:
                      message:
                        type: string
                        example: 현재 포인트 조회 성공
                      currentPoint:
                        type: integer
                        example: 1200
        "401":
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /api/v1/users/me/fcm-token:
    patch:
      summary: FCM 토큰 저장
      description: 사용자의 FCM 푸시 알림 토큰을 저장
      tags:
        - Users
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FcmTokenRequest'
      responses:
        '200':
          description: FCM 토큰 저장 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: "null"
                    example: null
                  success:
                    type: object
                    properties:
                      message:
                        type: string
                        example: fcmToken이 저장되었습니다.
        '400':
          description: 잘못된 요청 (fcmToken 누락 등)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/users/me/inactive:
    patch:
      summary: 휴면 계정 전환
      description: 인증된 사용자의 계정을 휴면 상태(`inactive`)로 전환
      tags:
        - Users
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 계정 휴면 전환 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 계정이 휴면 상태로 전환되었습니다.
                  user:
                    type: object
                    properties:
                      id:
                        type: string
                        example: "1"
                      status:
                        type: string
                        enum: [active, inactive]
                        example: inactive
                      inactivedAt:
                        type: string
                        format: date-time
                        example: "2025-07-17T15:46:09.924Z"
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/users/me/activate:
    patch:
      summary: 휴면 계정 활성화
      description: 휴면 상태인 계정을 다시 활성화
      tags:
        - Users
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 계정 활성화 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 계정이 다시 활성화되었습니다.
                  user:
                    type: object
                    properties:
                      id:
                        type: string
                        example: "1"
                      status:
                        type: string
                        enum: [active, inactive]
                        example: active
                      inactivedAt:
                        type: string
                        nullable: true
                        example: null
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/users/me:
    get:
      summary: 사용자 정보 조회
      description: 인증된 사용자의 정보를 조회
      tags:
        - Users
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 사용자 정보 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    $ref: '#/components/schemas/UserProfile'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/users/me/nickname:
    patch:
      summary: 닉네임 수정
      description: 인증된 사용자의 닉네임을 수정
      tags:
        - Users
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NicknameUpdateRequest'
      responses:
        '200':
          description: 닉네임 수정 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 닉네임이 성공적으로 변경되었습니다.
                  user:
                    type: object
                    properties:
                      id:
                        type: string
                        example: "2"
                      nickname:
                        type: string
                        example: 새로운닉네임
                      updatedAt:
                        type: string
                        format: date-time
                        example: "2025-07-18T06:49:44.605Z"
        '400':
          description: 잘못된 닉네임 형식
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/users/me/agreements:
    post:
      summary: 약관 동의 저장
      description: 인증된 사용자의 약관 동의 상태를 저장
      tags:
        - Users
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserAgreementRequest'
      responses:
        '200':
          description: 약관 동의 저장 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 약관 동의 저장 완료
                  agreement:
                    $ref: '#/components/schemas/UserAgreementResponse'
        '400':
          description: 필수 항목 누락 또는 잘못된 값
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/users/me/preferences:
    patch:
      summary: 선호 키워드 저장
      description: 인증된 사용자의 선호 키워드 목록을 저장하거나 업데이트합니다. 키워드는 카페 편의시설, 테이크아웃 혜택, 메뉴 특성 등으로 구분됩니다.
      tags:
        - Users
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserKeywordPreferenceRequest'
            example:
              preferredKeywords: ["노트북", "1인석", "디카페인", "텀블러 할인"]
      responses:
        '200':
          description: 키워드 저장 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 선호 키워드가 저장되었습니다.
                  storeFilters:
                    type: object
                    example:
                      노트북: true
                      1인석: true
                      단체석: false
                      주차 가능: false
                      예약 가능: false
                      와이파이 제공: false
                      애견 동반: false
                      24시간 운영: false
                  takeOutFilters:
                    type: object
                    example:
                      텀블러 할인: true
                      포장 할인: false
                  menuFilters:
                    type: object
                    example:
                      비건: false
                      디카페인: true
                      글루텐프리: false
                      저당/무가당: false
        '400':
          description: 잘못된 요청 (키워드 형식 오류 등)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    get:
      tags:
        - Users
      summary: 선호 키워드 조회
      description: preferredArea를 제외한 선호 키워드(매장, 테이크아웃, 메뉴) 선택 여부를 조회합니다.
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 선호 키워드 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 선호 키워드 조회 성공
                  data:
                    type: object
                    properties:
                      preferredStore:
                        type: object
                        example:
                          노트북: true
                          1인석: false
                      preferredTakeout:
                        type: object
                        example:
                          텀블러 할인: true
                          포장 할인: false
                      preferredMenu:
                        type: object
                        example:
                          비건: false
                          디카페인: true
        '404':
          description: 선호 키워드가 없음

  /api/v1/users/me/preferred-area:
    patch:
      summary: 자주 가는 동네 저장
      description: 인증된 사용자의 선호 지역(동네)을 저장하거나 업데이트
      tags:
        - Users
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserPreferredAreaRequest'
      responses:
        '200':
          description: 동네 저장 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: "null"
                    example: null
                  success:
                    type: object
                    properties:
                      message:
                        type: string
                        example: 자주 가는 동네가 저장되었습니다.
                      preferredArea:
                        type: string
                        example: 서울 마포구 신촌동
        '400':
          description: 유효하지 않은 동네명
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/users/me/kakao-alert:
    patch:
      summary: 카카오 알림톡 허용 여부 저장
      description: 인증된 사용자의 카카오 알림톡 수신 여부를 저장
      tags:
        - Users
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/KakaoAlertSettingRequest'
      responses:
        '200':
          description: 설정 저장 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: "null"
                    example: null
                  success:
                    type: object
                    properties:
                      message:
                        type: string
                        example: 카카오 알림톡이 허용되었습니다.
        '400':
          description: 잘못된 요청 (allowKakaoAlert 누락 등)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/users/me/bookmarks:
    get:
      summary: 북마크한 카페 목록 조회
      description: 인증된 사용자가 북마크한 카페 목록을 조회
      tags:
        - Users
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 북마크 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: "null"
                    example: null
                  success:
                    type: object
                    properties:
                      message:
                        type: string
                        example: 북마크한 카페 목록 조회 성공
                      bookmarks:
                        type: array
                        items:
                          $ref: '#/components/schemas/BookmarkedCafe'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/users/me/bookmarks:
    patch:
      summary: 북마크 추가
      description: 인증된 사용자가 특정 카페를 북마크
      tags:
        - Users
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BookmarkRequest'
      responses:
        '200':
          description: 북마크 저장 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: "null"
                    example: null
                  success:
                    type: object
                    properties:
                      message:
                        type: string
                        example: 북마크가 저장되었습니다.
                      cafeId:
                        type: string
                        example: "1"
        '400':
          description: 잘못된 요청 또는 이미 북마크된 카페
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/users/me/bookmarks/{cafeId}:
    delete:
      summary: 북마크 삭제
      description: 인증된 사용자가 특정 카페의 북마크를 삭제
      tags:
        - Users
      security:
        - bearerAuth: []
      parameters:
        - name: cafeId
          in: path
          required: true
          description: 삭제할 카페의 ID
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: 북마크 삭제 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: "null"
                    example: null
                  success:
                    type: object
                    properties:
                      message:
                        type: string
                        example: 북마크가 삭제되었습니다.
                      cafeId:
                        type: string
                        example: "1"
        '400':
          description: 존재하지 않는 북마크 또는 잘못된 요청
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/points/transactions:
    get:
      summary: 포인트 거래 내역 조회
      description: 인증된 사용자의 포인트 적립/사용/환불 내역을 최신순으로 조회
      tags:
        - Point
      security:
        - bearerAuth: []
      responses:
        "200":
          description: 포인트 거래 내역 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: "null"
                    example: null
                  success:
                    type: array
                    items:
                      $ref: "#/components/schemas/PointTransaction"
        "401":
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"


  /api/v1/pages/home:
    get:
      summary: 홈 정보 조회
      description: 사용자의 닉네임, 이번 달 스탬프 수, 이번 달 챌린지 수, 전체 스탬프 수, 총 포인트, 루피 레벨 정보를 반환합니다.
      tags:
        - Pages
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 홈 정보 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 홈 정보 조회 성공
                  data:
                    type: object
                    properties:
                      nickname:
                        type: string
                        example: 유진
                      thisMonthStampCount:
                        type: integer
                        example: 0
                      thisMonthChallengeCount:
                        type: integer
                        example: 0
                      totalStampCount:
                        type: integer
                        example: 0
                      totalPoint:
                        type: integer
                        example: 0
                      loopyLevel:
                        type: object
                        properties:
                          level:
                            type: integer
                            example: 1
                          label:
                            type: string
                            example: 호기심 많은 탐색가
        '401':
          description: 인증 실패 (토큰 누락 또는 유효하지 않음)
        '500':
          description: 서버 에러

  /api/v1/cafes/{cafeId}:
    get:
      tags:
        - Cafe
      summary: 카페 상세 정보 조회
      description: 카페 ID를 기반으로 상세 정보, 메뉴, 사진, 쿠폰, 스탬프북, 즐겨찾기 여부를 조회합니다
      operationId: getCafeDetail
      security:
        - bearerAuth: []
      parameters:
        - name: cafeId
          in: path
          description: 조회할 카페의 ID
          required: true
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: 성공적으로 카페 상세 정보를 조회했습니다
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CafeDetailResponse'
              example:
                resultType: "SUCCESS"
                error: null
                success:
                  cafe:
                    id: 1
                    name: "스타벅스 강남점"
                    address: "서울특별시 강남구 테헤란로 123"
                    businessHourType: "SAME_ALL_DAYS"
                    businessHours: 
                      "open": "10:00"
                      "close": "20:00"
                    breakTime: "14:00~15:00"
                    phone: "02-1234-5678"
                    websiteUrl: "https://starbucks.co.kr"
                    description: "프리미엄 커피 전문점"
                    storeFilters:
                      "1인석": true
                      "단체석": false
                      "노트북석": true
                      "애견 동반": false
                      "예약 가능": false
                      "주차 가능": true
                      "24시간 운영": false
                      "와이파이 제공": true
                    takeOutFilters:
                      "포장 할인": false
                      "텀블러 할인": true
                    menuFilters:
                      "비건": false
                      "디카페인": true
                      "글루텐프리": true
                      "저당/무가당": true
                    keywords:
                      - "커피"
                      - "스타벅스"
                  photos:
                    - id: 1
                      url: "https://image.starbucks.co.kr/upload/store/2021/04/store_exterior_1.jpg"
                      displayOrder: 1
                    - id: 2
                      url: "https://image.starbucks.co.kr/upload/store/2021/04/store_interior_1.jpg"
                      displayOrder: 2
                    - id: 3
                      url: "https://image.starbucks.co.kr/upload/store/2021/04/store_counter_1.jpg"
                      displayOrder: 3
                  menu:
                    - id: 1
                      name: "아메리카노"
                      price: 4500
                      description: "진한 에스프레소와 뜨거운 물을 더한 커피"
                      imgUrl: "https://image.starbucks.co.kr/upload/store/skuimg/2021/04/menu1.jpg"
                      isSoldOut: false
                      isRepresentative: true
                    - id: 2
                      name: "카페라떼"
                      price: 5000
                      description: "부드러운 우유와 에스프레소의 조화"
                      imgUrl: "https://image.starbucks.co.kr/upload/store/skuimg/2021/04/menu2.jpg"
                      isSoldOut: false
                      isRepresentative: true
                    - id: 4
                      name: "바닐라 스콘"
                      price: 3500
                      description: "촉촉하고 달콤한 바닐라 스콘"
                      imgUrl: "https://image.starbucks.co.kr/upload/store/skuimg/2021/04/menu4.jpg"
                      isSoldOut: true
                      isRepresentative: false
                    - id: 5
                      name: "초콜릿 머핀"
                      price: 4000
                      description: "진한 초콜릿이 들어간 머핀"
                      imgUrl: "https://image.starbucks.co.kr/upload/store/skuimg/2021/04/menu5.jpg"
                      isSoldOut: false
                      isRepresentative: false
                    - id: 3
                      name: "카푸치노"
                      price: 5000
                      description: "진한 에스프레소에 부드러운 우유거품"
                      imgUrl: "https://image.starbucks.co.kr/upload/store/skuimg/2021/04/menu3.jpg"
                      isSoldOut: false
                      isRepresentative: false
                  coupons:
                    - id: 1
                      name: "아메리카노 1000원 할인"
                      discountType: "AMOUNT"
                      discountValue: 1000
                      applicableMenu:
                        id: 1
                        cafeId: 1
                        category: "커피"
                        name: "아메리카노"
                        description: "진한 에스프레소와 뜨거운 물을 더한 커피"
                        price: 4500
                        isSoldOut: false
                        isRepresentative: true
                        photoUrl: "https://image.starbucks.co.kr/upload/store/skuimg/2021/04/menu1.jpg"
                        createdAt: "2025-07-30T13:09:53.000Z"
                        updatedAt: "2025-07-30T13:09:53.000Z"
                      createdAt: "2025-07-30T13:10:05.000Z"
                      expiredAt: "2025-09-28T13:10:05.000Z"
                      userCoupons:
                        - id: 3
                      isIssued: true
                    - id: 2
                      name: "10% 할인 쿠폰"
                      discountType: "DISCOUNT"
                      discountValue: 10
                      applicableMenu: null
                      createdAt: "2025-08-04T17:45:26.539Z"
                      expiredAt: "2025-12-31T23:59:59.000Z"
                      userCoupons: []
                      isIssued: false
                  Challenge:
                    id: 1
                    challengeId: 1
                    title: "3회 공부 인증 도전"
                    thumbnailUrl: "https://example.com/thumbnail.jpg"
                    startDate: "2025-08-01T00:00:00.000Z"
                    endDate: "2025-08-15T00:00:00.000Z"   
                  stampBook:
                    id: 1
                    currentCount: 3
                    goalCount: 10
                    expiresAt: "2025-08-29T13:09:13.000Z"
                    stampBookId: 1
                    stampImages:
                      - id: 1
                        imageUrl: "https://example.com/images/stamp1.png"
                  bookmark:
                    isBookmarked: true
        '401':
          description: 인증 실패 (토큰 누락 또는 만료)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CafeDetailErrorResponse'
              example:
                resultType: "ERROR"
                error:
                  code: "UNAUTHORIZED"
                  message: "유효하지 않은 토큰입니다"
                success: null
        '404':
          description: 존재하지 않는 카페
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CafeDetailErrorResponse'
              example:
                resultType: "ERROR"
                error:
                  code: "CAFE_NOT_FOUND"
                  message: "해당 카페를 찾을 수 없습니다"
                success: null
        '500':
          description: 서버 내부 오류
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CafeDetailErrorResponse'
              example:
                resultType: "ERROR"
                error:
                  code: "INTERNAL_SERVER_ERROR"
                  message: "서버 내부 오류가 발생했습니다"
                success: null

  /api/v1/cafes/{cafeId}/alram:
    post:
      tags:
        - Cafe
      summary: 카페 알람 설정/해제
      description: 사용자가 해당 카페에 대한 알람을 설정하거나 해제합니다. (알람 설정 상태에서 다시 요청 시 해제됨)
      security:
        - bearerAuth: []
      parameters:
        - name: cafeId
          in: path
          required: true
          schema:
            type: integer
          description: 알람 설정/해제할 카페의 ID
      responses:
        '200':
          description: 성공적으로 알람 설정/해제됨
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: "null"
                    nullable: true
                    example: null
                  success:
                    type: object
                    oneOf:
                      - description: 알람 설정 시 응답
                        properties:
                          data:
                            type: object
                            properties:
                              userId:
                                type: integer
                                example: 2
                              cafeId:
                                type: integer
                                example: 2
                          message:
                            type: string
                            example: 카페 알람 설정을 성공하였습니다.
                      - description: 알람 해제 시 응답
                        properties:
                          message:
                            type: string
                            example: 카페 알람 설정을 해제하였습니다.
        '401':
          description: 인증 실패 (토큰 없음/만료)
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: ERROR
                  error:
                    type: object
                    properties:
                      code:
                        type: string
                        example: UNAUTHORIZED
                      message:
                        type: string
                        example: "유효하지 않은 토큰입니다"
                  success:
                    type: "null"
                    example: null
        '404':
          description: 해당 카페 없음
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: ERROR
                  error:
                    type: object
                    properties:
                      code:
                        type: string
                        example: CAFE_NOT_FOUND
                      message:
                        type: string
                        example: "해당 카페를 찾을 수 없습니다"
                  success:
                    type: "null"
                    example: null

  /api/v1/cafes/{cafeId}/review:
    get:
      summary: 카페 리뷰 목록 조회 (페이징 지원)
      description: 카페 ID를 기반으로 리뷰를 커서 기반 페이징 방식으로 조회합니다.
      tags:
        - Cafe
      parameters:
        - in: path
          name: cafeId
          required: true
          schema:
            type: integer
          description: 리뷰를 조회할 카페 ID
        - in: query
          name: cursor
          required: false
          schema:
            type: integer
          description: 다음 페이지 조회를 위한 커서 (이전 응답의 nextCursor 값)
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 성공적으로 리뷰를 반환함
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: "null"
                    example: null
                  success:
                    type: object
                    properties:
                      reviews:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              example: 15
                            title:
                              type: string
                              example: "최근 방문 후기"
                            content:
                              type: string
                              example: "어제 다시 방문했는데 여전히 좋네요. 스콘이 새로 나왔던데 맛있더라고요. 다음에는 친구들도 데려올 예정이에요!"
                            nickname:
                              type: string
                              example: "커피러버1"
                            createdAt:
                              type: string
                              format: date-time
                              example: "2025-07-29T13:22:45.000Z"
                            images:
                              type: array
                              items:
                                type: string
                                format: uri
                              example: ["https://review-images.com/review_10_1.jpg"]
                      nextCursor:
                        type: integer
                        nullable: true
                        example: 13
                      hasNextPage:
                        type: boolean
                        example: true
              example:
                resultType: "SUCCESS"
                error: null
                success:
                  reviews:
                    - id: 15
                      content: "어제 다시 방문했는데 여전히 좋네요. 스콘이 새로 나왔던데 맛있더라고요. 다음에는 친구들도 데려올 예정이에요!"
                      nickname: "커피러버1"
                      createdAt: "2025-07-29T13:22:45.000Z"
                      images:
                        - "https://review-images.com/review_10_1.jpg"
                    - id: 14
                      content: "연인과 함께 갔는데 분위기도 좋고 음료도 맛있어서 대화가 더 즐거웠어요. 창가 자리 특히 예뻐요!"
                      nickname: "커피러버1"
                      createdAt: "2025-07-27T13:22:45.000Z"
                      images:
                        - "https://review-images.com/review_9_1.jpg"
                        - "https://review-images.com/review_9_2.jpg"
                        - "https://review-images.com/review_9_3.jpg"
                        - "https://review-images.com/review_9_4.jpg"
                    - id: 1
                      content: "아메리카노가 정말 진하고 맛있어요. 매장도 깔끔하고 직원분들도 친절합니다."
                      nickname: "커피러버1"
                      createdAt: "2025-07-27T13:07:43.000Z"
                      images:
                        - "https://review-images.com/review1_1.jpg"
                        - "https://review-images.com/review1_2.jpg"
                    - id: 2
                      content: "공부하기 좋은 환경이에요. 와이파이도 빠르고 콘센트도 많아서 노트북 사용하기 편해요."
                      nickname: "카페매니아2"
                      createdAt: "2025-07-25T13:07:43.000Z"
                      images:
                        - "https://review-images.com/review2_1.jpg"
                    - id: 13
                      content: "회사 근처라서 자주 오는데 항상 일정한 퀄리티를 유지해주셔서 고마워요. 믿고 마시는 아메리카노입니다."
                      nickname: "커피러버1"
                      createdAt: "2025-07-24T13:22:45.000Z"
                      images:
                        - "https://review-images.com/review_8_1.jpg"
                  nextCursor: 13
                  hasNextPage: true
        '401':
          description: 인증 실패 (토큰 없음/만료)
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: ERROR
                  error:
                    type: object
                    properties:
                      code:
                        type: string
                        example: UNAUTHORIZED
                      message:
                        type: string
                        example: "유효하지 않은 토큰입니다"
                  success:
                    type: "null"
                    example: null
        '404':
          description: 해당 카페 또는 리뷰 없음
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: ERROR
                  error:
                    type: object
                    properties:
                      code:
                        type: string
                        example: CAFE_NOT_FOUND
                      message:
                        type: string
                        example: "해당 카페를 찾을 수 없습니다"
                  success:
                    type: "null"
                    example: null

  /api/v1/cafes/{cafeId}/coupon:
    post:
      summary: 쿠폰 발급
      description: 사용자가 쿠폰 템플릿을 기반으로 프로모션 쿠폰을 발급받습니다.
      tags:
        - Cafe
      parameters:
        - in: path
          name: cafeId
          required: true
          schema:
            type: integer
          description: 쿠폰을 발급할 카페 ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id
                - createdAt
                - expiredAt
              properties:
                id:
                  type: integer
                  description: 발급할 쿠폰 템플릿의 ID
                  example: 1
                createdAt:
                  type: string
                  format: date-time
                  description: 쿠폰 생성 시간
                  example: "2025-07-20 18:17:16.000"
                expiredAt:
                  type: string
                  format: date-time
                  description: 쿠폰 만료 시간
                  example: "2025-12-31 23:59:59.000"
            example:
              id: 1
              createdAt: "2025-07-20 18:17:16.000"
              expiredAt: "2025-12-31 23:59:59.000"
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 쿠폰 발급 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: "null"
                    example: null
                  success:
                    type: object
                    properties:
                      id:
                        type: integer
                        example: 6
                      expiredAt:
                        type: string
                        format: date-time
                        example: "2025-12-31T14:59:59.000Z"
                      acquisitionType:
                        type: string
                        example: "promotion"
                      couponTemplate:
                        type: object
                        properties:
                          id:
                            type: integer
                            example: 1
                          name:
                            type: string
                            example: "아메리카노 1000원 할인"
                          discountType:
                            type: string
                            enum: [AMOUNT, PERCENTAGE]
                            example: "AMOUNT"
                          discountValue:
                            type: number
                            example: 1000
                          applicableMenu:
                            type: object
                            nullable: true
                            properties:
                              name:
                                type: string
                                example: "아메리카노"
                              description:
                                type: string
                                example: "진한 에스프레소와 뜨거운 물을 더한 커피"
                              photoUrl:
                                type: string
                                format: uri
                                example: "https://image.starbucks.co.kr/upload/store/skuimg/2021/04/menu1.jpg"
                          expiredAt:
                            type: string
                            format: date-time
                            example: "2025-09-28T13:10:05.000Z"
                      couponTemplateId:
                        type: integer
                        example: 1
              example:
                resultType: "SUCCESS"
                error: null
                success:
                  id: 6
                  expiredAt: "2025-12-31T14:59:59.000Z"
                  acquisitionType: "promotion"
                  couponTemplate:
                    id: 1
                    name: "아메리카노 1000원 할인"
                    discountType: "AMOUNT"
                    discountValue: 1000
                    applicableMenu:
                      name: "아메리카노"
                      description: "진한 에스프레소와 뜨거운 물을 더한 커피"
                      photoUrl: "https://image.starbucks.co.kr/upload/store/skuimg/2021/04/menu1.jpg"
                    expiredAt: "2025-09-28T13:10:05.000Z"
                  couponTemplateId: 1
        '409':
          description: 이미 발급받은 쿠폰 (중복 발급 방지)
          content:
            application/json:
              schema:
                type: object
                properties:
                  errorCode:
                    type: string
                    example: "C002"
                  reason:
                    type: string
                    example: "이미 발급받은 쿠폰입니다. 쿠폰 템플릿 ID: 1, 사용자 ID: 1"
                  data:
                    type: object
                    properties:
                      couponTemplateId:
                        type: integer
                        example: 1
                      userId:
                        type: integer
                        example: 1
              example:
                errorCode: "C002"
                reason: "이미 발급받은 쿠폰입니다. 쿠폰 템플릿 ID: 1, 사용자 ID: 1"
                data:
                  couponTemplateId: 1
                  userId: 1
        '401':
          description: 인증 실패 (JWT 누락 또는 유효하지 않음)
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: ERROR
                  error:
                    type: object
                    properties:
                      code:
                        type: string
                        example: UNAUTHORIZED
                      message:
                        type: string
                        example: "유효하지 않은 토큰입니다"
                  success:
                    type: "null"
                    example: null

  /api/v1/cafes/{cafeId}/bookmark:
    post:
      summary: 카페 북마크 생성
      description: 사용자가 특정 카페를 북마크합니다. 이미 북마크된 카페는 중복 저장되지 않습니다.
      tags:
        - Cafe
      security:
        - bearerAuth: []
      parameters:
        - name: cafeId
          in: path
          required: true
          schema:
            type: integer
          description: 북마크할 카페 ID
      responses:
        '200':
          description: 북마크 생성 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: "null"
                    example: null
                  success:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: 생성된 북마크 ID
                        example: 5
        '409':
          description: 이미 북마크한 카페
          content:
            application/json:
              schema:
                type: object
                properties:
                  errorCode:
                    type: string
                    example: BM001
                  reason:
                    type: string
                    example: 이미 북마크한 카페입니다.
                  data:
                    type: "null"
                    example: null


  /api/v1/search/{cafeId}:
    get:
      tags:
        - Search
      summary: 카페 정보 조회
      description: 카페 ID로 특정 카페의 상세 정보를 조회합니다
      operationId: getCafeInfo
      security:
        - bearerAuth: []
      parameters:
        - name: cafeId
          in: path
          description: 카페 고유 ID
          required: true
          schema:
            type: string
            example: "1"
        - name: x
          in: query
          description: X 좌표 (경도)
          required: false
          schema:
            type: number
            format: double
            example: 127.027610
        - name: y
          in: query
          description: Y 좌표 (위도)
          required: false
          schema:
            type: number
            format: double
            example: 37.497942
      responses:
        '200':
          description: 성공적으로 카페 정보를 조회했습니다
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CafeSearchResponse'
              example:
                resultType: "SUCCESS"
                error: null
                success:
                  id: "1"
                  name: "로스터리 카페"
                  keywords:
                    - "커피"
                    - "로스팅"
                  photos:
                    - id: "1"
                      url: "https://example.com/photos/roastery-exterior.jpg"
                      displayOrder: 1
                    - id: "2"
                      url: "https://example.com/photos/roastery-interior.jpg"
                      displayOrder: 2
                    - id: "3"
                      url: "https://example.com/photos/roastery-counter.jpg"
                      displayOrder: 3
                    - id: "4"
                      url: "https://example.com/photos/roastery-beans.jpg"
                      displayOrder: 4
                    - id: "5"
                      url: "https://example.com/photos/roastery-seating.jpg"
                      displayOrder: 5
                  distance: 100
        '400':
          description: 잘못된 요청
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CafeSearchErrorResponse'
              example:
                resultType: "ERROR"
                error:
                  code: "INVALID_PARAMETER"
                  message: "유효하지 않은 좌표입니다"
                success: null
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CafeSearchErrorResponse'
              example:
                resultType: "ERROR"
                error:
                  code: "UNAUTHORIZED"
                  message: "유효하지 않은 토큰입니다"
                success: null
        '404':
          description: 카페를 찾을 수 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CafeSearchErrorResponse'
              example:
                resultType: "ERROR"
                error:
                  code: "CAFE_NOT_FOUND"
                  message: "해당 위치에서 카페를 찾을 수 없습니다"
                success: null
        '500':
          description: 서버 내부 오류
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CafeSearchErrorResponse'
              example:
                resultType: "ERROR"
                error:
                  code: "INTERNAL_SERVER_ERROR"
                  message: "서버 내부 오류가 발생했습니다"
                success: null

  /api/v1/search/map:
      get:
        tags:
          - Search
        summary: 지도 기반 카페 검색
        description: 좌표와 줌 레벨을 기반으로 주변 카페를 검색하고 다양한 필터를 적용합니다
        operationId: searchCafesOnMap
        security:
          - bearerAuth: []
        parameters:
          - name: x
            in: query
            description: X 좌표 (경도)
            required: true
            schema:
              type: number
              format: double
              example: 126.9374
          - name: y
            in: query
            description: Y 좌표 (위도)
            required: true
            schema:
              type: number
              format: double
              example: 37.5581
          - name: zoom
            in: query
            description: 지도 줌 레벨
            required: true
            schema:
              type: integer
              example: 3
              minimum: 1
              maximum: 20
          - name: store
            in: query
            description: 매장 필터 (콤마로 구분된 값들)
            required: false
            schema:
              type: string
              enum: 
                - single_seat
                - group_seat
                - laptop_seat
                - pet_friendly
                - reservation
                - parking
                - 24hours
                - wifi
            explode: false
            style: form
          - name: menu
            in: query
            description: 메뉴 필터 (콤마로 구분된 값들)
            required: false
            schema:
              type: string
              enum:
                - vegan
                - decaf
                - gluten_free
                - sugar_free
            explode: false
            style: form
          - name: takeout
            in: query
            description: 테이크아웃 필터 (콤마로 구분된 값들)
            required: false
            schema:
              type: string
              enum:
                - package_discount
                - tumbler_discount
            explode: false
            style: form
        responses:
          '200':
            description: 성공적으로 카페 목록을 조회했습니다
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/CafeMapSearchResponse'
                examples:
                  basic_search:
                    summary: 기본 검색 (필터 없음)
                    value:
                      resultType: "SUCCESS"
                      error: null
                      success:
                        cafes:
                          - id: 10
                            name: "스타벅스 강남역점"
                            latitude: 37.497175
                            longitude: 127.027926
                            isStamped: false
                          - id: 11
                            name: "투썸플레이스 강남점"
                            latitude: 37.498234
                            longitude: 127.029871
                            isStamped: false
                          - id: 13
                            name: "카페베네 강남역점"
                            latitude: 37.495876
                            longitude: 127.025431
                            isStamped: false
                        totalCount: 3
                        searchRadius: 320
                        zoomLevel: "3"
                        center:
                          x: 127.027926
                          y: 37.497175
                  filtered_search:
                    summary: 필터 적용 검색 (wifi 필터)
                    value:
                      resultType: "SUCCESS"
                      error: null
                      success:
                        cafes:
                          - id: 10
                            name: "스타벅스 강남역점"
                            latitude: 37.497175
                            longitude: 127.027926
                            isStamped: false
                          - id: 11
                            name: "투썸플레이스 강남점"
                            latitude: 37.498234
                            longitude: 127.029871
                            isStamped: false
                          - id: 13
                            name: "카페베네 강남역점"
                            latitude: 37.495876
                            longitude: 127.025431
                            isStamped: false
                          - id: 12
                            name: "블루보틀 강남점"
                            latitude: 37.499123
                            longitude: 127.030945
                            isStamped: false
                          - id: 14
                            name: "로컬카페 '소소한하루'"
                            latitude: 37.500456
                            longitude: 127.032187
                            isStamped: false
                          - id: 1
                            name: "로스터리 카페"
                            latitude: 37.5009
                            longitude: 127.0363
                            isStamped: true
                        totalCount: 6
                        searchRadius: 2560
                        zoomLevel: "6"
                        center:
                          x: 127.027926
                          y: 37.497175
          '400':
            description: 잘못된 요청
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/CafeMapSearchErrorResponse'
                example:
                  resultType: "ERROR"
                  error:
                    code: "INVALID_PARAMETER"
                    message: "유효하지 않은 좌표 또는 줌 레벨입니다"
                  success: null
          '401':
            description: 인증 실패
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/CafeMapSearchErrorResponse'
                example:
                  resultType: "ERROR"
                  error:
                    code: "UNAUTHORIZED"
                    message: "유효하지 않은 토큰입니다"
                  success: null
          '500':
            description: 서버 내부 오류
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/CafeMapSearchErrorResponse'
                example:
                  resultType: "ERROR"
                  error:
                    code: "INTERNAL_SERVER_ERROR"
                    message: "서버 내부 오류가 발생했습니다"
                  success: null

  /api/v1/search/list:
    post:
      summary: 카페 검색 목록 조회
      description: 사용자 위치 기반으로 카페를 검색하고, 필터링 및 키워드 검색을 지원합니다.
      tags:
        - Search
      parameters:
        - in: query
          name: x
          required: true
          schema:
            type: number
            format: float
          description: 사용자 경도 좌표 (필수)
          example: 127.0276
        - in: query
          name: y
          required: true
          schema:
            type: number
            format: float
          description: 사용자 위도 좌표 (필수)
          example: 37.4979
        - in: query
          name: searchQuery
          required: false
          schema:
            type: string
          description: 검색 키워드 (선택)
          example: "스타벅스"
        - in: query
          name: cursor
          required: false
          schema:
            type: integer
          description: 페이징을 위한 커서 (선택)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                storeFilters:
                  type: object
                  description: 매장 필터 조건
                  example: {}
                takeOutFilters:
                  type: object
                  description: 테이크아웃 필터 조건
                  example: {}
                menuFilters:
                  type: object
                  description: 메뉴 필터 조건
                  example: {}
                addressInfo:
                  type: object
                  properties:
                    region_1depth_name:
                      type: string
                      example: "서울특별시"
                    region_2depth_name:
                      type: string
                      example: "강남구"
                    region_3depth_name:
                      type: string
                      example: "역삼동"
            example:
              storeFilters: {}
              takeOutFilters: {}
              menuFilters: {}
              addressInfo: {}
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 성공적으로 카페 목록을 조회했습니다
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: "null"
                    example: null
                  success:
                    type: object
                    properties:
                      fromNLP:
                        type: boolean
                        example: false
                      data:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              example: 1
                            name:
                              type: string
                              example: "스타벅스 강남점"
                            address:
                              type: string
                              example: "서울특별시 강남구 테헤란로 123"
                            keywords:
                              type: array
                              items:
                                type: string
                              example: ["커피", "강남"]
                            latitude:
                              type: number
                              format: float
                              example: 37.5665
                            longitude:
                              type: number
                              format: float
                              example: 126.978
                            region1DepthName:
                              type: string
                              example: "서울특별시"
                            region2DepthName:
                              type: string
                              example: "강남구"
                            region3DepthName:
                              type: string
                              example: "역삼동"
                            createdAt:
                              type: string
                              format: date-time
                              example: "2025-07-30T13:03:54.000Z"
                            photos:
                              type: array
                              items:
                                type: object
                                properties:
                                  id:
                                    type: integer
                                    example: 1
                                  photoUrl:
                                    type: string
                                    format: uri
                                    example: "https://image.starbucks.co.kr/upload/store/2021/04/store_exterior_1.jpg"
                            bookmarkedBy:
                              type: array
                              items:
                                type: object
                                properties:
                                  id:
                                    type: integer
                                    example: 4
                            distance:
                              type: integer
                              description: 사용자로부터의 거리 (미터 단위)
                              example: 6800389
                            isBookmarked:
                              type: boolean
                              example: true
                      nextCursor:
                        type: integer
                        nullable: true
                        example: null
                      hasMore:
                        type: boolean
                        example: false
              examples:
                without_search:
                  summary: 전체 카페 목록 조회
                  value:
                    resultType: "SUCCESS"
                    error: null
                    success:
                      fromNLP: false
                      data:
                        - id: 1
                          name: "스타벅스 강남점"
                          address: "서울특별시 강남구 테헤란로 123"
                          keywords: ["커피", "스타벅스"]
                          latitude: 37.5665
                          longitude: 126.978
                          region1DepthName: "서울특별시"
                          region2DepthName: "강남구"
                          region3DepthName: "역삼동"
                          createdAt: "2025-07-30T13:03:54.000Z"
                          photos:
                            - id: 1
                              photoUrl: "https://image.starbucks.co.kr/upload/store/2021/04/store_exterior_1.jpg"
                          bookmarkedBy:
                            - id: 4
                          distance: 6800389
                          isBookmarked: true
                        - id: 9
                          name: "컴포즈커피 역삼점"
                          address: "서울특별시 강남구 역삼로 789"
                          keywords: ["컴포즈커피", "저렴한커피"]
                          latitude: 37.4995
                          longitude: 127.0365
                          region1DepthName: "서울특별시"
                          region2DepthName: "강남구"
                          region3DepthName: "역삼동"
                          createdAt: "2025-07-30T15:08:07.000Z"
                          photos:
                            - id: 12
                              photoUrl: "https://picsum.photos/400/300?random=31"
                          bookmarkedBy:
                            - id: 9
                          distance: 6802254
                          isBookmarked: true
                        - id: 11
                          name: "메가커피 선릉점"
                          address: "서울특별시 강남구 선릉로 321"
                          keywords: ["메가커피", "저렴한커피"]
                          latitude: 37.5044
                          longitude: 127.0489
                          region1DepthName: "서울특별시"
                          region2DepthName: "강남구"
                          region3DepthName: "역삼동"
                          createdAt: "2025-07-30T15:08:07.000Z"
                          photos:
                            - id: 16
                              photoUrl: "https://picsum.photos/400/300?random=51"
                          bookmarkedBy: []
                          distance: 6801107
                          isBookmarked: false
                      nextCursor: null
                      hasMore: false
                with_search:
                  summary: 키워드 검색 결과
                  value:
                    resultType: "SUCCESS"
                    error: null
                    success:
                      fromNLP: false
                      data:
                        - id: 1
                          name: "스타벅스 강남점"
                          address: "서울특별시 강남구 테헤란로 123"
                          keywords: ["커피", "스타벅스"]
                          latitude: 37.5665
                          longitude: 126.978
                          region1DepthName: "서울특별시"
                          region2DepthName: "강남구"
                          region3DepthName: "역삼동"
                          createdAt: "2025-07-30T13:03:54.000Z"
                          photos:
                            - id: 1
                              photoUrl: "https://image.starbucks.co.kr/upload/store/2021/04/store_exterior_1.jpg"
                          bookmarkedBy:
                            - id: 4
                          distance: 6800389
                          isBookmarked: true
                      nextCursor: null
                      hasMore: false
        '400':
          description: 잘못된 요청 (필수 좌표 누락)
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: ERROR
                  error:
                    type: object
                    properties:
                      code:
                        type: string
                        example: BAD_REQUEST
                      message:
                        type: string
                        example: "사용자 좌표(x, y)는 필수입니다"
                  success:
                    type: "null"
                    example: null
        '401':
          description: 인증 실패 (JWT 누락 또는 유효하지 않음)
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: ERROR
                  error:
                    type: object
                    properties:
                      code:
                        type: string
                        example: UNAUTHORIZED
                      message:
                        type: string
                        example: "유효하지 않은 토큰입니다"
                  success:
                    type: "null"
                    example: null

  /api/v1/challenges:
    get:
      summary: 챌린지 목록 조회
      description: 현재 유효한 챌린지 목록을 조회합니다. (종료일 오름차순 정렬)
      tags: [Challenge]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                    description: 응답 결과 타입 (항상 'SUCCESS')
                  error:
                    type: string
                    nullable: true
                    example: null
                    description: 에러 메시지 (정상 응답 시 null)
                  success:
                    type: array
                    description: 유효한 챌린지 목록
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 1
                        title:
                          type: string
                          example: 친구와 함께하는 카공 챌린지
                        description:
                          type: string
                          example: 혼자보다 함께일 때 더 집중돼요!
                        thumbnailUrl:
                          type: string
                          example: https://cdn.loopy.com/challenges/1.jpg
                        startDate:
                          type: string
                          format: date
                          example: 2025-08-01
                        endDate:
                          type: string
                          format: date
                          example: 2025-08-30
                        isParticipated:
                          type: boolean
                          example: true

  /api/v1/challenges/{challengeId}:
    get:
      summary: 챌린지 상세 조회
      description: 챌린지 ID로 상세 정보를 조회합니다.
      tags: [Challenge]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: challengeId
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                    description: 응답 결과 상태
                  error:
                    type: string
                    nullable: true
                    example: null
                    description: 에러 메시지 (정상 응답 시 null)
                  success:
                    type: object
                    description: 챌린지 상세 정보
                    properties:
                      id:
                        type: integer
                        example: 1
                      title:
                        type: string
                        example: 친구와 함께하는 카공 챌린지
                      description:
                        type: string
                        example: 친구와 함께 카페에서 공부하며 인증하는 루피 챌린지입니다.
                      thumbnailUrl:
                        type: string
                        example: https://cdn.loopy.com/challenges/1.jpg
                      startDate:
                        type: string
                        format: date
                        example: 2025-08-01
                      endDate:
                        type: string
                        format: date
                        example: 2025-08-30
                      goalDescription:
                        type: string
                        example: 카페에서 공부 인증 3회
                      goalCount:
                        type: integer
                        example: 3
                      rewardPoint:
                        type: integer
                        example: 300
                      isParticipated:
                        type: boolean
                        example: true
                      joinedCafe:
                        type: object
                        nullable: true
                        description: 유저가 참여 중일 경우, 선택한 매장 정보
                        properties:
                          id:
                            type: integer
                            example: 12
                          name:
                            type: string
                            example: 카페 위니
                      joinedCount:
                        type: integer
                        description: >
                          참여 중인 경우, 챌린지 기간 내 '참여 가능 매장'에서 사용자가 적립한 스탬프 수.
                          미참여 시 0.
                        example: 2
                      availableCafes:
                        type: array
                        description: 챌린지 참여 가능한 카페 목록
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              example: 12
                            name:
                              type: string
                              example: 카페 위니
                            address:
                              type: string
                              example: 서울 서대문구 이화여대길 52
                            image:
                              type: string
                              nullable: true
                              description: 카페 대표 이미지(첫 번째 사진). 없으면 null.
                              example: https://cdn.loopy.com/cafes/12.jpg
                            region1DepthName:
                              type: string
                              example: 서울특별시
                            region2DepthName:
                              type: string
                              example: 서대문구
                            region3DepthName:
                              type: string
                              example: 이화동


  /api/v1/challenges/{challengeId}/join:
    post:
      summary: 챌린지 참여
      description: 해당 챌린지에 로그인 유저가 참여합니다. 참여 시 선택한 매장 ID를 함께 전달해야 합니다.
      tags: [Challenge]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: challengeId
          required: true
          schema:
            type: integer
          description: 참여할 챌린지의 ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - joinedCafeId
              properties:
                joinedCafeId:
                  type: integer
                  example: 12
                  description: 유저가 선택한 참여 매장의 ID
      responses:
        '200':
          description: 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: string
                    nullable: true
                    example: null
                  success:
                    type: object
                    properties:
                      message:
                        type: string
                        example: 챌린지 참여가 완료되었습니다.

  success:
  type: array
  description: 참여 가능한 카페 목록
  items:
    type: object
    properties:
      cafeId:
        type: integer
        example: 12
        description: 카페 ID
      name:
        type: string
        example: 카페 위니
        description: 카페 이름
      address:
        type: string
        example: 서울 서대문구 이화여대길 52
      image:
        type: string
        example: https://cdn.loopy.com/cafes/12.jpg
        description: 카페 대표 이미지 URL
      region1DepthName:
        type: string
        example: 서울특별시
        description: 시/도
      region2DepthName:
        type: string
        example: 서대문구
        description: 구/군
      region3DepthName:
        type: string
        example: 이화동
        description: 동/읍/면
      distance:
        type: number
        example: 500
        description: 거리 (단위: 미터, 위치 기반 계산)


  /api/v1/users/me/challenges:
    get:
      summary: 나의 챌린지 목록 조회
      description: 로그인 유저가 현재 참여 중인 챌린지 목록을 조회합니다. (진행 중 상태만 반환)
      tags: [Challenge]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: string
                    nullable: true
                    example: null
                  success:
                    type: array
                    description: 유저가 현재 참여 중인 챌린지 리스트
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 3
                          description: 챌린지 ID
                        title:
                          type: string
                          example: 환경 보호 챌린지
                          description: 챌린지 제목
                        thumbnailUrl:
                          type: string
                          example: https://cdn.loopy.com/challenges/3.jpg
                          description: 챌린지 썸네일 이미지 URL
                        tag:
                          type: string
                          nullable: true
                          example: ECO
                          description: 챌린지 태그 (nullable)
                        startDate:
                          type: string
                          format: date
                          example: 2025-08-01
                          description: 챌린지 시작일
                        endDate:
                          type: string
                          format: date
                          example: 2025-08-31
                          description: 챌린지 종료일

  /api/v1/challenges/{challengeId}/complete:
    post:
      summary: 챌린지 완료 처리
      description: 챌린지를 완료 처리하고 쿠폰을 발급합니다.
      tags: [Challenge]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: challengeId
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType: { type: string }
                  error: { type: string, nullable: true }
                  success:
                    type: object
                    properties:
                      message: { type: string }
                      couponId: { type: integer, nullable: true }

  /api/v1/users/me/stampbooks:
    get:
      summary: 전체 스탬프북 조회
      description: 로그인한 사용자의 진행 중 스탬프북을 정렬 기준에 따라 조회합니다.
      tags: [Stamp]
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: sortBy
          schema:
            type: string
            enum: [mostStamped, shortestDeadline]
            default: shortestDeadline
          description: |
            정렬 기준
            - `mostStamped`: 적립 많은 순 (currentCount desc, expiresAt asc)
            - `shortestDeadline`: 기한 짧은 순 (expiresAt asc)
      responses:
        '200':
          description: 스탬프북 리스트 조회 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StampBookListSuccessResponse'

  /api/v1/users/me/stampbooks/{stampBookId}:
    get:
      summary: 스탬프북 상세 조회
      description: 특정 스탬프북의 상세 정보를 조회합니다.
      tags: [Stamp]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: stampBookId
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: 스탬프북 상세 조회 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StampBookDetailSuccessResponse'
        '400':
          description: 잘못된 요청 (유효하지 않은 스탬프북 ID 등)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 접근 권한 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: 리소스를 찾을 수 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # /api/v1/users/me/stampbooks/{stampBookId}/stamps:
  #   post:
  #     summary: 도장 적립
  #     description: 스탬프북에 도장 1개 적립 (QR or 수동 방식)
  #     tags:
  #       - Stamp
  #     security:
  #       - bearerAuth: []
  #     parameters:
  #       - in: path
  #         name: stampBookId
  #         required: true
  #         schema:
  #           type: integer
  #     requestBody:
  #       required: true
  #       content:
  #         application/json:
  #           schema:
  #             type: object
  #             properties:
  #               cafeId:
  #                 type: integer
  #               method:
  #                 type: string
  #                 enum: [QR, MANUAL]
  #     responses:
  #       '200':
  #         description: 도장 적립 성공
  #         content:
  #           application/json:
  #             schema:
  #               type: object
  #               properties:
  #                 stampCount:
  #                   type: integer
  #                 isStampbookCompleted:
  #                   type: boolean

  /api/v1/users/me/stampbooks/{stampBookId}/convert:
    post:
      summary: 스탬프 → 포인트 환전
      description: |
        해당 스탬프북의 **모든 스탬프를 포인트로 환전**합니다.
        환전 성공 시 스탬프북은 `converted` 상태가 되며 `currentCount`가 0으로 초기화됩니다.
      tags: [Stamp]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: stampBookId
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: 환전 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StampConversionSuccessResponse'
              example:
                status: SUCCESS
                code: 200
                message: "카페 위니의 5개의 스탬프가 10포인트로 환전되었습니다."
                data:
                  stampBookId: 12
                  cafeId: 3
                  cafeName: 카페 위니
                  stampCount: 5
                  pointPerStamp: 2
                  pointAmount: 10
                  remainingStampCount: 0
                  convertedAt: "2025-07-31T09:10:30.000Z"
        '400':
          description: 잘못된 요청 (예: 스탬프 0개, 이미 환전된 상태, 유효하지 않은 ID 등)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                NO_STAMPS:
                  summary: 환전 가능한 스탬프 없음
                  value: { status: FAIL, code: 400, message: 환전 가능한 스탬프가 없습니다. }
                ALREADY_CONVERTED:
                  summary: 이미 환전(종료)된 스탬프북
                  value: { status: FAIL, code: 400, message: 이미 환전(종료)된 스탬프북입니다. }
                INVALID_ID:
                  summary: 유효하지 않은 스탬프북 ID
                  value: { status: FAIL, code: 400, message: 유효하지 않은 스탬프북 ID입니다. }
        '403':
          description: 접근 권한 없음 (본인 소유 아님)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example: { status: FAIL, code: 403, message: 본인의 스탬프북만 환전할 수 있습니다. }
        '404':
          description: 스탬프북을 찾을 수 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example: { status: FAIL, code: 404, message: 존재하지 않는 스탬프buk입니다. }

  /api/v1/users/me/stampbooks/{stampBookId}/extend:
    patch:
      summary: 스탬프북 기간 연장
      description: 진행 중인 스탬프북의 만료일을 1회에 한해 14일 연장합니다. 이미 연장된 경우 또는 완료된 스탬프북은 연장할 수 없습니다.
      tags: [Stamp]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: stampBookId
          required: true
          schema: { type: integer }
      responses:
        '200':
          description: 연장 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StampBookExtensionSuccessResponse'
        '400':
          description: 잘못된 요청
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 접근 권한 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: 스탬프북을 찾을 수 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/users/me/stampbooks/expiring:
    get:
      summary: 소멸 임박 스탬프북 조회
      description: 7일 이내 만료 예정인 active 스탬프북 목록을 반환합니다.
      tags: [Stamp]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExpiringStampBooksSuccessResponse'
              example:
                status: SUCCESS
                code: 200
                message: 소멸 임박 스탬프북 조회 성공
                data:
                  - id: 12
                    cafe:
                      id: 3
                      name: 카페 위니
                      address: 서울 서대문구 이화여대길 52
                      image: https://example.com/photo.jpg
                    round: 2
                    rewardDetail: 스탬프 10개 모으면 아메리카노 한 잔 무료
                    goalCount: 10
                    currentCount: 6
                    progressPercent: 60
                    status: active
                    isCompleted: false
                    expiresAt: "2025-08-15T00:00:00.000Z"
                    daysUntilExpiration: 3
                    isExpiringSoon: true
                    previewRewardText: 4회 후 포인트로 자동 환전돼요!
                    canExtend: true


  /api/v1/users/me/stampbooks/converted:
    get:
      summary: 환전 완료된 스탬프북 히스토리(카페별 그룹)
      description: 사용자가 환전한 스탬프북을 **카페별로 그룹핑**하여 최근 환전 순으로 반환합니다.
      tags: [Stamp]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 환전 히스토리(카페별) 조회 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConvertedStampBookHistoryByCafeSuccessResponse'
              example:
                status: SUCCESS
                code: 200
                message: 환전 히스토리(카페별) 조회 성공
                data:
                  - cafeId: 7
                    cafeName: 블루보틀 연남점
                    cafeAddress: 서울특별시 마포구 연남동 123-45
                    cafeImageUrl: https://example.com/photo.jpg
                    completedCount: 2
                    items:
                      - stampBookId: 15
                        round: 3
                        completedAt: "2025-07-30T09:00:00.000Z"
                        convertedAt: "2025-07-31T13:45:00.000Z"
                        displayText: 스탬프지 3장 완료
                      - stampBookId: 11
                        round: 2
                        completedAt: "2025-06-10T10:00:00.000Z"
                        convertedAt: "2025-06-10T12:00:00.000Z"
                        displayText: 스탬프지 2장 완료
        '500':
          description: 서버 오류
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

          '500':
            description: 서버 오류
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'



  /api/v1/users/me/stamps/total-count:
      get:
      summary: 총 스탬프 수 조회
      description: 로그인한 사용자가 보유한 전체 스탬프 개수를 반환합니다. 모든 스탬프북에 적립된 도장의 수를 합산한 값입니다.
      tags:
        - Stamp
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 총 스탬프 수 조회 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TotalStampCountResponse'
        '500':
          description: 서버 오류
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'


  /api/v1/users/me/stampbooks/loopy-level:
      get:
        summary: 루피 레벨 조회
        description: 사용자가 보유한 스탬프북 개수에 따라 루피 레벨을 계산합니다.
        tags:
          - Stamp
        security:
          - bearerAuth: []
        responses:
          '200':
            description: 루피 레벨 조회 성공
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/LoopyLevelResponse'
          '500':
            description: 서버 오류
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'

  /api/v1/users/me/notification:
    get:
      tags:
        - Notifications
      summary: 알림 목록 조회
      description: 로그인한 사용자의 모든 알림을 최신순으로 조회합니다. `content` 필드는 문자열 또는 객체(JSON) 형식일 수 있습니다.
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 알림 목록 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 알림 목록 조회 성공
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        notificationId:
                          type: integer
                          example: 42
                        cafeId:
                          type: integer
                          nullable: true
                          example: 3
                        cafeName:
                          type: string
                          nullable: true
                          example: 루피커피
                        title:
                          type: string
                          example: 스탬프 적립 조건이 변경됐어요!
                        content:
                          oneOf:
                            - type: string
                              example: 8월 1일부터 스탬프는 5,000원 이상 결제 시 적립됩니다.
                            - type: object
                              example:
                                conditionType: AMOUNT
                                minAmount: 5000
                                stampPerAmount: 1
                                drinkCount: null
                                stampPerCount: null
                                rewardType: DISCOUNT
                                discountAmount: 1500
                                menuId: null
                        type:
                          type: string
                          enum: [cafe, stamp, review]
                        isRead:
                          type: boolean
                          example: false
                        createdAt:
                          type: string
                          format: date-time
                          example: 2025-07-31T13:12:00.000Z
        '401':
          description: 인증 실패 (JWT 누락 또는 만료)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'


  /api/v1/notification/{notificationId}:
    get:
      tags:
        - Notifications
      summary: 알림 상세 조회
      description: 알림 ID를 기반으로 상세 정보를 조회합니다. 읽지 않은 알림이라면 읽음 처리됩니다. 모든 알림 유형은 관련된 카페 상세페이지로 이동됩니다.
      security:
        - bearerAuth: []
      parameters:
        - name: notificationId
          in: path
          required: true
          description: 조회할 알림 ID
          schema:
            type: integer
      responses:
        '200':
          description: 알림 상세 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 알림 상세 조회 성공
                  data:
                    type: object
                    properties:
                      notificationId:
                        type: integer
                        example: 12
                      type:
                        type: string
                        enum: [cafe, stamp, review]
                      createdAt:
                        type: string
                        format: date-time
                        example: 2025-07-31T12:34:56.000Z
                      cafe:
                        type: object
                        nullable: true
                        properties:
                          id:
                            type: integer
                            example: 1
                          name:
                            type: string
                            example: 루피커피
                          address:
                            type: string
                            example: 서울시 성북구 성북로 123
        '404':
          description: 알림이 존재하지 않음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  
  /api/v1/cafes/{cafeId}/my-stamp:
    get:
      summary: 카페 내 내 스탬프 현황 조회
      description: 로그인한 사용자가 특정 카페에 대해 보유한 스탬프북의 도장 개수, 목표 개수, 만료일 정보를 조회합니다.
      tags:
        - Stamp
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: cafeId
          required: true
          schema:
            type: integer
          description: 조회할 대상 카페 ID
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: string
                    nullable: true
                    example: null
                  success:
                    type: object
                    properties:
                      stampBookId:
                        type: integer
                        example: 23
                        description: 해당 카페의 스탬프북 ID
                      currentCount:
                        type: integer
                        example: 4
                        description: 현재 도장 수
                      goalCount:
                        type: integer
                        example: 10
                        description: 목표 도장 수
                      expiresAt:
                        type: string
                        format: date
                        example: 2025-08-15
                        description: 스탬프북 만료일
        '404':
          description: 해당 카페에 대한 스탬프북 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: 서버 오류
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/stampbooks/{cafeId}/coupon:
      post:
        tags:
          - StampBooks
        summary: 스탬프 목표 달성 시 리워드 쿠폰 발급
        description: 스탬프북의 목표를 달성한 경우, 사용자에게 리워드 쿠폰을 발급합니다.
        security:
          - bearerAuth: []
        parameters:
          - name: cafeId
            in: path
            required: true
            description: 쿠폰을 발급받을 카페 ID
            schema:
              type: integer
        responses:
          '200':
            description: 리워드 쿠폰 발급 성공
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    message:
                      type: string
                      example: 리워드 쿠폰 발급 성공
                    coupon:
                      $ref: '#/components/schemas/UserCoupon'
          '400':
            description: 스탬프북이 조건을 만족하지 않음 또는 잘못된 요청
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '401':
            description: 인증되지 않은 사용자
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '404':
            description: 스탬프북 또는 카페를 찾을 수 없음
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'

  /api/v1/user-coupons:
    get:
      tags:
        - UserCoupons
      summary: 사용자의 쿠폰 목록 조회
      description: status 쿼리 파라미터로 사용 가능한 쿠폰 또는 지난 쿠폰을 조회합니다.
      security:
        - bearerAuth: []
      parameters:
        - name: status
          in: query
          required: false
          schema:
            type: string
            enum: [usable, past]
            default: usable
          description: 조회할 쿠폰 상태 (usable: 사용 가능, past: 사용됨 또는 만료됨)
      responses:
        '200':
          description: 쿠폰 목록 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 유저 쿠폰 ID
                          example: 12
                        status:
                          type: string
                          enum: [active, used, expired]
                          example: active
                        expiredAt:
                          type: string
                          format: date-time
                          example: 2025-08-31T23:59:59.000Z
                        usedAt:
                          type: string
                          format: date-time
                          nullable: true
                          example: null
                        cafeId:
                          type: integer
                          example: 5
                        cafeImage:
                          type: string
                          nullable: true
                          example: https://cdn.loopy.com/cafes/5/main.jpg
                        usageCondition:
                          type: string
                          nullable: true
                          example: 1만원 이상 구매 시
                        couponTemplate:
                          type: object
                          properties:
                            name: { type: string, example: 아메리카노 1000원 할인 }
                            discountType:
                              type: string
                              enum: [DISCOUNT, FREE_DRINK, SIZE_UP]
                              example: DISCOUNT
                            discountValue: { type: integer, nullable: true, example: 1000 }
                            applicableMenuId: { type: integer, nullable: true, example: 17 }
                            startDate: { type: string, format: date-time, nullable: true, example: 2025-08-10T00:00:00.000Z }
                            endDate: { type: string, format: date-time, nullable: true, example: 2025-08-31T23:59:59.000Z }
        '400':
          description: 잘못된 쿠폰 상태 요청
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: FAIL
                  error:
                    type: object
                    properties:
                      errorCode:
                        type: string
                        example: U001
                      reason:
                        type: string
                        example: 올바르지 않은 쿠폰 상태입니다: abc
                      data:
                        type: object
                        nullable: true

  /api/v1/user-coupons/{userCouponId}:
    patch:
      tags:
        - UserCoupons
      summary: 쿠폰 사용 처리
      description: 사용자가 보유한 쿠폰을 사용 처리합니다. 사용된 쿠폰은 더 이상 사용할 수 없습니다.
      security:
        - bearerAuth: []
      parameters:
        - name: userCouponId
          in: path
          required: true
          description: 사용 처리할 쿠폰 ID
          schema:
            type: integer
      responses:
        '200':
          description: 쿠폰 사용 처리 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 쿠폰 사용 처리 성공
                  coupon:
                    $ref: '#/components/schemas/UserCoupon'
        '400':
          description: 이미 사용되었거나 만료된 쿠폰
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: 쿠폰을 찾을 수 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/cafe/{cafeId}/review:
      post:
        tags:
          - Review
        summary: 리뷰 작성
        description: 본문 500자 이하, 이미지 최대 5장까지 첨부 가능합니다.
        security:
          - bearerAuth: []
        parameters:
          - name: cafeId
            in: path
            required: true
            schema:
              type: integer
            description: 리뷰를 작성할 카페 ID
        requestBody:
          required: true
          content:
            multipart/form-data:
              schema:
                type: object
                required:
                  - content
                properties:
                  content:
                    type: string
                    example: >
                      카페 위치가 조용한 골목에 있어 외부 소음이 거의 없어 집중하기에 정말 좋은 환경이었습니다.
                      좌석 간 간격이 넓어 프라이버시도 잘 지켜졌고, 무엇보다 직원분들의 친절한 응대가 기억에 남습니다.
                      다음에도 꼭 다시 방문하고 싶고, 지인들에게도 추천하고 싶은 카페입니다.
                      별점을 5개 이상 줄 수 있다면 주고 싶을 정도로 만족스러운 경험이었습니다.
                  images:
                    type: array
                    items:
                      type: string
                      format: binary
                    description: 첨부 이미지 파일 (최대 5장)
        responses:
          '201':
            description: 리뷰 작성 성공
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    message:
                      type: string
                      example: 리뷰 작성 성공
                    review:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 123
                        title:
                          type: string
                          example: "루피카페"
                        content:
                          type: string
                          example: "(테스트) 리뷰 본문입니다."
                        userId:
                          type: integer
                          example: 1
                        images:
                          type: array
                          items:
                            type: string
                          example: ["https://s3.bucket/review1.jpg"]
          '400':
            description: 잘못된 요청 (제목/본문 미입력, 유효성 실패 등)
            content:
              application/json:
                examples:
                  본문 없음:
                    value: { errorCode: "R005", reason: "제목과 본문을 모두 입력해주세요." }
                  본문 500자 초과:
                    value: { errorCode: "R002", reason: "본문은 최소 500자까지만 작성할 수 있습니다." }
                  이미지 타입 오류:
                    value: { errorCode: "R006", reason: "이미지 파일 형식만 업로드할 수 있습니다. (받은 타입: text/plain)" }
                  이미지 수량 초과:
                    value: { errorCode: "R007", reason: "이미지는 최대 5개까지만 업로드할 수 있습니다. (받은 수량: 6개)" }
          '403':
            description: 유효한 스탬프가 없음
            content:
              application/json:
                example:
                  value: { errorCode: "R008", reason: "스탬프 적립을 시작하고 리뷰를 작성해보세요!" }
          '500':
            description: 서버 오류

  /api/v1/reviews/{reviewId}:
    patch:
      tags:
        - Review
      summary: 리뷰 수정
      description: 본인의 리뷰만 수정할 수 있습니다.
      security:
        - bearerAuth: []
      parameters:
        - name: reviewId
          in: path
          required: true
          schema:
            type: integer
          description: 수정할 리뷰 ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - title
                - content
              properties:
                title:
                  type: string
                  example: "업데이트된 제목입니다."
                content:
                  type: string
                  example: "내용도 새롭게 작성했습니다."
      responses:
        '200':
          description: 리뷰 수정 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 리뷰 수정 성공
                  review:
                    type: object
                    properties:
                      id:
                        type: integer
                        example: 123
                      title:
                        type: string
                        example: "루피카페"
                      content:
                        type: string
                        example: "(수정) 리뷰 본문입니다."
                      userId:
                        type: integer
                        example: 1
                      images:
                        type: array
                        items:
                          type: string
                        example: ["https://s3.bucket/review1.jpg"]
        '403':
          description: 권한 없음
          content:
            application/json:
              example:
                value: { errorCode: "R004", reason: "본인의 리뷰만 수정/삭제할 수 있습니다." }
        '404':
          description: 리뷰 없음
          content:
            application/json:
              example:
                value: { errorCode: "R003", reason: "ID 123에 해당하는 리뷰가 존재하지 않습니다." }
        '400':
          description: 필수 필드 누락
          content:
            application/json:
              example:
                value: { errorCode: "R005", reason: "제목과 본문을 모두 입력해주세요." }
        '500':
          description: 서버 오류

    delete:
      tags:
        - Review
      summary: 리뷰 삭제
      description: 본인이 작성한 리뷰만 삭제할 수 있습니다.
      security:
        - bearerAuth: []
      parameters:
        - name: reviewId
          in: path
          required: true
          schema:
            type: integer
          description: 삭제할 리뷰 ID
      responses:
        '200':
          description: 리뷰 삭제 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 리뷰 삭제 성공!
        '403':
          description: 권한 없음
          content:
            application/json:
              example:
                value: { errorCode: "R004", reason: "본인의 리뷰만 수정/삭제할 수 있습니다." }
        '404':
          description: 리뷰 없음
          content:
            application/json:
              example:
                value: { errorCode: "R003", reason: "ID 123에 해당하는 리뷰가 존재하지 않습니다." }
        '500':
          description: 서버 오류

  /api/v1/users/me/reviews:
    get:
      tags:
        - Review
      summary: 내가 작성한 리뷰 목록 조회
      description: 로그인한 사용자가 작성한 리뷰 목록을 페이지네이션 형식으로 조회합니다.
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          required: false
          schema:
            type: integer
            default: 1
          description: 조회할 페이지 번호
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 10
          description: 페이지당 항목 수
      responses:
        '200':
          description: 내가 쓴 리뷰 목록 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 내가 쓴 리뷰 목록 조회 성공
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/UserReviewSummary'
                  pagination:
                    type: object
                    properties:
                      page:
                        type: integer
                        example: 1
                      limit:
                        type: integer
                        example: 10
                      total:
                        type: integer
                        example: 27
        '401':
          description: 인증 실패
          content:
            application/json:
              example:
                value: { errorCode: "AUTH001", reason: "JWT 토큰이 유효하지 않습니다." }
        '500':
          description: 서버 오류

  /api/v1/owner/cafes/basic-info:
    post:
      tags: [Admin Cafe]
      summary: 카페 기본 정보 등록
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - address
                - region1DepthName
                - region2DepthName
                - region3DepthName
                - latitude
                - longitude
                - ownerName
              properties:
                name:
                  type: string
                address:
                  type: string
                region1DepthName:
                  type: string
                region2DepthName:
                  type: string
                region3DepthName:
                  type: string
                latitude:
                  type: number
                  format: float
                longitude:
                  type: number
                  format: float
                ownerName:
                  type: string
                phone:
                  type: string
                websiteUrl:
                  type: string
                description:
                  type: string
            example:
              name: "테스트카페"
              address: "서울시 마포구 테스트로 123"
              region1DepthName: "서울특별시"
              region2DepthName: "마포구"
              region3DepthName: "서교동"
              latitude: 37.567167
              longitude: 126.946347
              ownerName: "홍길동"
              phone: "01012345678"
              websiteUrl: "https://testcafe.example.com"
              description: "테스트용 카페입니다."
      responses:
        201:
          description: 카페 기본 정보 등록 성공

  /api/v1/owner/cafes/operation:
    patch:
      tags: [Admin Cafe]
      summary: 내 카페 운영 정보 수정
      description: 운영시간, 버튼 상태, 브레이크타임, 해시태그, 키워드 정보를 수정합니다.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - businessHourType
                - businessHours
              properties:
                businessHourType:
                  type: string
                  description: 운영 시간 입력 방식 선택값
                  enum: [SAME_ALL_DAYS, WEEKDAY_WEEKEND, DIFFERENT_EACH_DAY]
                  example: SAME_ALL_DAYS
                businessHours:
                  description: 요일별 또는 구분별 운영 시간 정보
                  oneOf:
                    - type: object
                      description: 모든 날 동일
                      properties:
                        open:
                          type: string
                          example: "10:00"
                        close:
                          type: string
                          example: "20:00"
                    - type: object
                      description: 평일/주말 구분
                      properties:
                        weekday:
                          type: object
                          properties:
                            open:
                              type: string
                              example: "09:00"
                            close:
                              type: string
                              example: "18:00"
                        weekend:
                          type: object
                          properties:
                            open:
                              type: string
                              example: "11:00"
                            close:
                              type: string
                              example: "17:00"
                    - type: array
                      description: 요일별 각각 다름
                      items:
                        type: object
                        properties:
                          day:
                            type: string
                            example: "월"
                          isClosed:
                            type: boolean
                            example: false
                          openTime:
                            type: string
                            example: "09:00"
                          closeTime:
                            type: string
                            example: "18:00"
                breakTime:
                  type: string
                  description: 전체 브레이크 타임 (호환용, 현재 미사용 가능)
                  example: "14:00~15:00"
                keywords:
                  type: array
                  description: 대표 해시태그 (최대 2개)
                  items:
                    type: string
                    example: "루프탑"
                storeFilters:
                  type: array
                  description: 매장 관련 키워드
                  items:
                    type: string
                    example: "노트북"
                takeOutFilters:
                  type: array
                  description: 테이크아웃 관련 키워드
                  items:
                    type: string
                    example: "텀블러 할인"
                menuFilters:
                  type: array
                  description: 메뉴 관련 키워드
                  items:
                    type: string
                    example: "디카페인"
            examples:
              sameAllDays:
                summary: 모든 날 동일
                value:
                  businessHourType: SAME_ALL_DAYS
                  businessHours:
                    open: "10:00"
                    close: "20:00"
                  breakTime: "14:00~15:00"
                  keywords: ["루프탑", "브런치"]
                  storeFilters: ["노트북", "단체석"]
                  takeOutFilters: ["텀블러 할인"]
                  menuFilters: ["비건", "디카페인"]
              weekdayWeekend:
                summary: 평일/주말 다름
                value:
                  businessHourType: WEEKDAY_WEEKEND
                  businessHours:
                    weekday:
                      open: "09:00"
                      close: "18:00"
                    weekend:
                      open: "11:00"
                      close: "17:00"
                  breakTime: "14:00~15:00"
                  keywords: ["한옥카페", "디저트"]
                  storeFilters: ["주차 가능"]
                  takeOutFilters: ["포장 할인"]
                  menuFilters: ["저당"]
              differentEachDay:
                summary: 요일별 각각 다름
                value:
                  businessHourType: DIFFERENT_EACH_DAY
                  businessHours:
                    - day: "월"
                      isClosed: false
                      openTime: "09:00"
                      closeTime: "18:00"
                    - day: "화"
                      isClosed: false
                      openTime: "09:00"
                      closeTime: "18:00"
                    - day: "수"
                      isClosed: false
                      openTime: "10:00"
                      closeTime: "19:00"
                    - day: "목"
                      isClosed: false
                      openTime: "10:00"
                      closeTime: "19:00"
                    - day: "금"
                      isClosed: false
                      openTime: "11:00"
                      closeTime: "20:00"
                    - day: "토"
                      isClosed: true
                    - day: "일"
                      isClosed: true
                  breakTime: "14:00~15:00"
                  keywords: ["루프탑", "야경"]
                  storeFilters: ["애견 동반"]
                  takeOutFilters: ["텀블러 할인"]
                  menuFilters: ["디카페인"]
      responses:
        200:
          description: 운영 정보 수정 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    description: 카페 ID
                    example: 3
                  businessHourType:
                    type: string
                    example: WEEKDAY_WEEKEND
                  businessHours:
                    oneOf:
                      - type: object
                        example:
                          open: "10:00"
                          close: "20:00"
                      - type: object
                        example:
                          weekday:
                            open: "09:00"
                            close: "18:00"
                          weekend:
                            open: "11:00"
                            close: "17:00"
                      - type: array
                        example:
                          - day: "월"
                            isClosed: false
                            openTime: "09:00"
                            closeTime: "18:00"
                          - day: "화"
                            isClosed: false
                            openTime: "09:00"
                            closeTime: "18:00"
                          - day: "수"
                            isClosed: false
                            openTime: "10:00"
                            closeTime: "19:00"
                  storeFilters:
                    type: array
                    items:
                      type: string
                    example: ["노트북", "단체석"]
                  takeOutFilters:
                    type: array
                    items:
                      type: string
                    example: ["텀블러 할인"]
                  menuFilters:
                    type: array
                    items:
                      type: string
                    example: ["디카페인"]
                  keywords:
                    type: array
                    items:
                      type: string
                    example: ["루프탑", "브런치"]



  /api/v1/owner/cafes/menus:
    post:
      summary: 카페 메뉴 등록
      description: 사장님이 카페의 메뉴를 등록합니다. 이미지 파일은 S3에 업로드됩니다.
      tags:
        - Admin Cafe
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: 아메리카노
                price:
                  type: integer
                  example: 4500
                description:
                  type: string
                  example: 깊고 진한 커피
                isRepresentative:
                  type: boolean
                  example: true
                menuImage:
                  type: string
                  format: binary
      responses:
        '201':
          description: 카페 메뉴가 등록되었습니다.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 카페 메뉴가 등록되었습니다.
                  data:
                    type: object
                    properties:
                      id:
                        type: integer
                        example: 1
                      cafeId:
                        type: integer
                        example: 4
                      name:
                        type: string
                        example: 아메리카노
                      price:
                        type: integer
                        example: 4500
                      description:
                        type: string
                        example: 깊고 진한 커피
                      isSoldOut:
                        type: boolean
                        example: false
                      isRepresentative:
                        type: boolean
                        example: true
                      photoUrl:
                        type: string
                        example: https://your-bucket.s3.ap-northeast-2.amazonaws.com/menus/1690884398_아메리카노.jpg
                      createdAt:
                        type: string
                        format: date-time
                      updatedAt:
                        type: string
                        format: date-time
        '400':
          description: 유효하지 않은 입력 값
        '409':
          description: 메뉴 이름 중복 또는 대표 메뉴 초과

  /api/v1/owner/cafes/photos:
    post:
      tags: [Admin Cafe]
      summary: 카페 사진 등록
      description: |
        클라이언트는 사진 파일을 전송합니다. 서버가 해당 파일을 S3에 업로드하고, URL을 저장합니다.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                photos:
                  type: array
                  items:
                    type: string
                    format: binary
            encoding:
              photos:
                style: form
      responses:
        201:
          description: 사진 등록 성공
    get:
      tags:
        - Admin Cafe
      summary: 내 카페 사진 조회
      description: 로그인한 사장님의 카페에 등록된 사진 목록을 조회합니다.
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 내 카페 사진 목록 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 내 카페 사진 조회 성공
                  data:
                    type: object
                    properties:
                      result:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              example: 3
                            cafeId:
                              type: integer
                              example: 12
                            photoUrl:
                              type: string
                              example: https://loopy-bucket.s3.ap-northeast-2.amazonaws.com/cafes/123/photos/abcdef.jpg
                            displayOrder:
                              type: integer
                              example: 1
                            createdAt:
                              type: string
                              format: date-time
                              example: 2025-08-12T09:12:34.000Z
        '401':
          description: 인증 실패
        '404':
          description: 카페가 존재하지 않습니다 (CafeNotExistError)


  /api/v1/owner/cafes/complete:
    patch:
      tags: [Admin Cafe]
      summary: 카페 등록 완료 처리
      security:
        - bearerAuth: []
      responses:
        200:
          description: 등록 완료

  /api/v1/owner/cafes/photos:
    get:
      tags: [Admin Cafe]
      summary: 내가 등록한 카페의 사진 조회
      security:
        - bearerAuth: []
      responses:
        200:
          description: 사진 조회 성공

  /api/v1/owner/cafes/photos/{photoId}:
    delete:
      tags: [Admin Cafe]
      summary: 특정 카페 사진 삭제
      security:
        - bearerAuth: []
      parameters:
        - name: photoId
          in: path
          required: true
          description: 삭제할 사진의 ID
          schema:
            type: integer
            example: 42
      responses:
        200:
          description: 삭제 성공
          content:
            application/json:
              example:
                resultType: "SUCCESS"
                error: null
                success:
                  message: "카페 이미지가 삭제되었습니다."
                  photoId: 4
              
  /api/v1/owner/cafes/myCafe/basic:
    get:
      tags: [Admin Cafe]
      summary: 내 카페 기본 정보 조회
      description: 로그인한 사장님의 카페 기본 정보를 조회
      responses:
        200:
          description: 카페 기본 정보 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    type: string
                    description: 업체명
                    example: "끄적끄적 카페"
                  ownerName:
                    type: string
                    description: 대표자 이름
                    example: "홍길동"
                  address:
                    type: string
                    description: 상세 주소
                    example: "서울 마포구 와우산로 123"
                  region1DepthName:
                    type: string
                    description: 시/도
                    example: "서울특별시"
                  region2DepthName:
                    type: string
                    description: 시/군/구
                    example: "마포구"
                  region3DepthName:
                    type: string
                    description: 동/리
                    example: "서교동"
                  phone:
                    type: string
                    description: 전화번호
                    example: "010-1234-5678"
                  description:
                    type: string
                    description: 카페 소개글
                    example: "감성 편지가 있는 공간"
                  websiteUrl:
                    type: string
                    description: SNS 링크
                    example: "https://instagram.com/yourcafe"
                  photos:
                    type: array
                    description: 카페 사진 리스트
                    items:
                      type: object
                      properties:
                        photoUrl:
                          type: string
                          description: 사진 URL
                          example: "https://s3.aws.com/cafe/photo1.jpg"
  
  /api/v1/owner/cafes/myCafe/operation:
    get:
      tags: [Admin Cafe]
      summary: 내 카페 운영 정보 조회
      description: 사장님의 카페 운영 시간, 브레이크타임(옵션), 해시태그 및 필터 키워드(버튼 선택 상태) 조회
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 내 카페 운영 정보 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 내 카페 운영 정보 조회 성공
                  data:
                    type: object
                    properties:
                      id:
                        type: integer
                        description: 카페 ID
                        example: 3
                      businessHourType:
                        type: string
                        description: 운영 시간 입력 방식
                        enum: [SAME_ALL_DAYS, WEEKDAY_WEEKEND, DIFFERENT_EACH_DAY]
                        example: SAME_ALL_DAYS
                      businessHours:
                        description: 운영 시간 값(선택한 타입에 따라 형태 상이)
                        oneOf:
                          - type: object
                            description: 모든 날 동일 (SAME_ALL_DAYS)
                            properties:
                              open:
                                type: string
                                example: "10:00"
                              close:
                                type: string
                                example: "20:00"
                          - type: object
                            description: 평일/주말 구분 (WEEKDAY_WEEKEND)
                            properties:
                              weekday:
                                type: object
                                properties:
                                  open:
                                    type: string
                                    example: "09:00"
                                  close:
                                    type: string
                                    example: "18:00"
                              weekend:
                                type: object
                                properties:
                                  open:
                                    type: string
                                    example: "11:00"
                                  close:
                                    type: string
                                    example: "17:00"
                          - type: array
                            description: 요일별 각각 다름 (DIFFERENT_EACH_DAY)
                            items:
                              type: object
                              properties:
                                day:
                                  type: string
                                  example: "월"
                                isClosed:
                                  type: boolean
                                  example: false
                                openTime:
                                  type: string
                                  example: "09:00"
                                closeTime:
                                  type: string
                                  example: "18:00"
                      breakTime:
                        type: string
                        description: 전체 브레이크 타임 (호환용, 미사용 가능)
                        example: "14:00~15:00"
                      keywords:
                        type: array
                        description: 대표 해시태그 (최대 2개)
                        items:
                          type: string
                        example: ["루프탑", "브런치"]
                      storeFilters:
                        type: array
                        description: 매장 관련 키워드(버튼 선택 상태)
                        items:
                          type: string
                        example: ["노트북", "단체석"]
                      takeOutFilters:
                        type: array
                        description: 테이크아웃 관련 키워드(버튼 선택 상태)
                        items:
                          type: string
                        example: ["텀블러 할인"]
                      menuFilters:
                        type: array
                        description: 메뉴 관련 키워드(버튼 선택 상태)
                        items:
                          type: string
                        example: ["디카페인", "비건"]
              examples:
                sameAllDays:
                  summary: 모든 날 동일
                  value:
                    message: 내 카페 운영 정보 조회 성공
                    data:
                      id: 3
                      businessHourType: SAME_ALL_DAYS
                      businessHours:
                        open: "10:00"
                        close: "20:00"
                      breakTime: "14:00~15:00"
                      keywords: ["루프탑", "브런치"]
                      storeFilters: ["노트북", "단체석"]
                      takeOutFilters: ["텀블러 할인"]
                      menuFilters: ["디카페인"]
                weekdayWeekend:
                  summary: 평일/주말 다름
                  value:
                    message: 내 카페 운영 정보 조회 성공
                    data:
                      id: 3
                      businessHourType: WEEKDAY_WEEKEND
                      businessHours:
                        weekday:
                          open: "09:00"
                          close: "18:00"
                        weekend:
                          open: "11:00"
                          close: "17:00"
                      breakTime: "14:00~15:00"
                      keywords: ["한옥카페", "디저트"]
                      storeFilters: ["주차 가능"]
                      takeOutFilters: ["포장 할인"]
                      menuFilters: ["저당"]
                differentEachDay:
                  summary: 요일별 각각 다름
                  value:
                    message: 내 카페 운영 정보 조회 성공
                    data:
                      id: 3
                      businessHourType: DIFFERENT_EACH_DAY
                      businessHours:
                        - day: "월"
                          isClosed: false
                          openTime: "09:00"
                          closeTime: "18:00"
                        - day: "화"
                          isClosed: false
                          openTime: "09:00"
                          closeTime: "18:00"
                        - day: "수"
                          isClosed: false
                          openTime: "10:00"
                          closeTime: "19:00"
                        - day: "목"
                          isClosed: false
                          openTime: "10:00"
                          closeTime: "19:00"
                        - day: "금"
                          isClosed: false
                          openTime: "11:00"
                          closeTime: "20:00"
                        - day: "토"
                          isClosed: true
                        - day: "일"
                          isClosed: true
                      breakTime: "14:00~15:00"
                      keywords: ["루프탑", "야경"]
                      storeFilters: ["애견 동반"]
                      takeOutFilters: ["텀블러 할인"]
                      menuFilters: ["디카페인"]
        '401':
          description: 인증 실패
        '404':
          description: 카페가 존재하지 않습니다


  /api/v1/owner/cafes/myCafe/menus:
    get:
      tags: [Admin Cafe]
      summary: 내 카페 메뉴 전체 요약 조회
      description: 사장님이 등록한 모든 메뉴의 요약 정보를 조회합니다.
      responses:
        200:
          description: 메뉴 요약 리스트 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 내 카페 메뉴 목록 조회 성공
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 1
                        name:
                          type: string
                          example: "아이스 아메리카노"
                        price:
                          type: integer
                          example: 4500
                        photoUrl:
                          type: string
                          nullable: true
                          example: "https://s3.amazonaws.com/cafe/menu1.jpg"
                        isRepresentative:
                          type: boolean
                          example: true
                        description:
                          type: string
                          example: "산미가 좋은 에티오피아 원두를 사용한 커피입니다."

  /api/v1/owner/cafes/menus/{menuId}:
    delete:
      tags:
        - Admin Cafe
      summary: 카페 메뉴 삭제
      description: 메뉴 ID로 해당 메뉴를 삭제합니다. 로그인한 사장님의 카페에 속한 메뉴만 삭제할 수 있습니다.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: menuId
          required: true
          schema:
            type: integer
          description: 삭제할 메뉴의 ID
          example: 5
      responses:
        '200':
          description: 메뉴 삭제 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 카페 메뉴가 삭제되었습니다.
                  data:
                    type: object
                    properties:
                      menuId:
                        type: integer
                        example: 5
        '401':
          description: 인증 실패
        '403':
          description: 해당 메뉴에 대한 접근 권한이 없습니다.
        '404':
          description: 메뉴가 존재하지 않습니다.



  /api/v1/owner/cafes/photos/first:
    get:
      summary: 카페의 첫 번째 등록 사진 조회
      description: 특정 카페에 등록된 사진 중 createdAt 기준으로 가장 먼저 등록된 사진 1장을 조회합니다.
      tags:
        - CafePhoto
      responses:
        200:
          description: 첫 번째 사진 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  photo:
                    type: object
                    properties:
                      id:
                        type: integer
                      cafeId:
                        type: integer
                      photoUrl:
                        type: string
                      displayOrder:
                        type: integer
                      createdAt:
                        type: string
                        format: date-time
        404:
          description: 등록된 사진이 없는 경우
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        400:
          description: 잘못된 요청 (예: cafeId가 숫자가 아님)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/owner/stamps/stamp-images:
    post:
      tags: [Admin Cafe]
      summary: 스탬프 이미지 업로드
      description: |
        사장님이 스탬프 이미지를 업로드합니다. 카페별 최대 2개까지 등록 가능합니다.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                images:
                  type: array
                  items:
                    type: string
                    format: binary
                  maxItems: 2
              required:
                - images
            encoding:
              images:
                style: form
                explode: true
      responses:
        '201':
          description: 이미지 업로드 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 스탬프 이미지 업로드 성공
                  data:
                    type: array
                    description: 업로드된 스탬프 이미지 목록
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 3
                        imageUrl:
                          type: string
                          example: https://your-bucket.s3.ap-northeast-2.amazonaws.com/cafes/stamps/xxxxxxxx-xxxx.png
        '400':
          description: 유효하지 않은 요청(파일 없음, 2개 초과 등)
        '401':
          description: 인증 실패
        '415':
          description: 지원하지 않는 파일 형식

    get:
      tags: [Admin Cafe]
      summary: 스탬프 이미지 전체 조회
      description: 로그인된 사장님의 카페에 등록된 스탬프 이미지 목록을 최신순으로 반환합니다.
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 스탬프 이미지 조회 성공
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 12
                        imageUrl:
                          type: string
                          example: https://your-bucket.s3.ap-northeast-2.amazonaws.com/cafes/stamps/xxxxxxxx-xxxx.png
                        createdAt:
                          type: string
                          format: date-time
                          example: 2025-08-11T05:00:00.000Z
                        updatedAt:
                          type: string
                          format: date-time
                          example: 2025-08-11T05:00:00.000Z
        '401':
          description: 인증 실패
        '404':
          description: 카페를 찾을 수 없음

  /api/v1/admin/stamps/stamp-images/{imageId}:
    delete:
      tags: [Admin Cafe]
      summary: 스탬프 이미지 삭제
      description: 로그인된 사장님의 카페에 등록된 스탬프 이미지 1장을 삭제합니다. (S3에서 삭제 후 DB 레코드 삭제)
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: imageId
          required: true
          schema:
            type: integer
          description: 삭제할 스탬프 이미지의 ID
      responses:
        '200':
          description: 스탬프 이미지 삭제 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 스탬프 이미지 삭제 성공
                  success:
                    type: boolean
                    example: true
        '400':
          description: 잘못된 요청 (imageId 유효하지 않음)
        '401':
          description: 인증 실패
        '403':
          description: 권한 없음 (해당 카페의 소유자가 아님)
        '404':
          description: 스탬프 이미지가 존재하지 않음

  /api/v1/owner/stamps/stamp-policy:
    post:
      tags: [Admin Cafe]
      summary: 스탬프 정책 등록
      description: >
        사장님이 스탬프 적립 정책을 등록합니다. 금액 기준 또는 횟수 기준, 리워드 종류에 따라 조건이 달라집니다.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - selectedImageUrl
                - conditionType
                - rewardType
              properties:
                selectedImageUrl:
                  type: string
                  example: https://your-bucket.s3.ap-northeast-2.amazonaws.com/stamps/1691223650_1.png
                conditionType:
                  type: string
                  enum: [AMOUNT, COUNT]
                  example: AMOUNT
                amountThreshold:
                  type: integer
                  nullable: true
                  example: 5000
                stampCountAmount:
                  type: integer
                  nullable: true
                  example: 1
                drinkCount:
                  type: integer
                  nullable: true
                  example: null
                stampCountDrink:
                  type: integer
                  nullable: true
                  example: null
                rewardType:
                  type: string
                  enum: [DISCOUNT, SIZE_UP, FREE_DRINK]
                  example: DISCOUNT
                discountAmount:
                  type: integer
                  nullable: true
                  example: 1000
                menuId:
                  type: integer
                  nullable: true
                  example: null
      responses:
        '201':
          description: 스탬프 정책 등록 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 스탬프 정책이 등록되었습니다.
                  data:
                    type: object
                    example:
                      id: 1
                      cafeId: 3
                      selectedImageUrl: https://...
                      conditionType: AMOUNT
                      stampPerAmount: 1
                      rewardType: DISCOUNT
                      discountAmount: 1000
        '400':
          description: 유효하지 않은 요청
        '401':
          description: 인증되지 않은 사용자
        '409':
          description: 이미 등록된 정책 존재 시 에러
            
    get:
      tags: [Admin Cafe]
      summary: 스탬프 정책 조회
      description: > 
        로그인한 사장님의 카페에 등록된 스탬프 정책을 조회합니다.
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 스탬프 정책 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 스탬프 정책 조회 성공
                  data:
                    type: object
                    properties:
                      id:
                        type: integer
                        example: 1
                      cafeId:
                        type: integer
                        example: 4
                      selectedImageUrl:
                        type: string
                        example: https://your-bucket.s3.ap-northeast-2.amazonaws.com/stamps/stamp1.png
                      conditionType:
                        type: string
                        enum: [AMOUNT, COUNT]
                        example: COUNT
                      drinkCount:
                        type: integer
                        nullable: true
                        example: 10
                      stampPerCount:
                        type: integer
                        nullable: true
                        example: 1
                      rewardType:
                        type: string
                        enum: [DISCOUNT, SIZE_UP, FREE_DRINK]
                        example: FREE_DRINK
                      menuId:
                        type: integer
                        nullable: true
                        example: 3
                      discountAmount:
                        type: integer
                        nullable: true
                        example: null
                      createdAt:
                        type: string
                        format: date-time
                      updatedAt:
                        type: string
                        format: date-time
        '401':
          description: 인증되지 않은 사용자
        '404':
          description: 등록된 스탬프 정책이 없는 경우

    patch:
      tags: [Admin Cafe]
      summary: 스탬프 정책 수정
      description: >
        로그인한 사장님의 기존 스탬프 정책을 수정합니다.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - selectedImageUrl
                - conditionType
                - rewardType
              properties:
                selectedImageUrl:
                  type: string
                  example: https://your-bucket.s3.ap-northeast-2.amazonaws.com/stamps/stamp1.png
                conditionType:
                  type: string
                  enum: [AMOUNT, COUNT]
                  example: COUNT
                amountThreshold:
                  type: integer
                  nullable: true
                  example: null
                stampCountAmount:
                  type: integer
                  nullable: true
                  example: null
                drinkCount:
                  type: integer
                  nullable: true
                  example: 10
                stampCountDrink:
                  type: integer
                  nullable: true
                  example: 1
                rewardType:
                  type: string
                  enum: [DISCOUNT, SIZE_UP, FREE_DRINK]
                  example: FREE_DRINK
                discountAmount:
                  type: integer
                  nullable: true
                  example: null
                menuId:
                  type: integer
                  nullable: true
                  example: 3
      responses:
        '200':
          description: 스탬프 정책 수정 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 스탬프 정책이 수정되었습니다.
                  data:
                    type: object
                    $ref: '#/components/schemas/StampPolicy'
        '400':
          description: 유효하지 않은 요청
        '401':
          description: 인증되지 않은 사용자
        '404':
          description: 정책이 존재하지 않음

  /api/v1/owner/dashboard/stamp-stats:
    get:
      tags:
        - Admin Dashboard
      summary: 내 카페 최근 7일 스탬프 통계 조회
      description: |
        사장님의 카페에 대해 아래 항목들의 통계를 조회합니다.
        - 오늘 적립된 스탬프 수
        - 최근 7일(오늘 포함) 적립된 스탬프 수
        - 최근 7일 일자별 스탬프 적립 수
        - 스탬프를 적립한 고객 수 (중복 제거)
        - 전체 스탬프 적립 수
        - 리워드 지급 수 (스탬프북이 goalCount에 도달한 경우)
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 스탬프 통계 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 스탬프 통계 조회 성공
                  data:
                    type: object
                    properties:
                      todayStampCount:
                        type: integer
                        example: 5
                      last7DaysStampCount:
                        type: integer
                        example: 32
                      totalStampCount:
                        type: integer
                        example: 150
                      uniqueUserCount:
                        type: integer
                        example: 40
                      rewardGivenCount:
                        type: integer
                        example: 10
                      dailyStampCounts:
                        type: array
                        description: 최근 7일간 일자별 스탬프 수
                        items:
                          type: object
                          properties:
                            date:
                              type: string
                              example: '2025-08-06'
                            count:
                              type: integer
                              example: 4
        '401':
          description: 인증되지 않은 사용자
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: 서버 오류
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'


  /api/v1/users/owner:
    delete:
      summary: 사장 회원 탈퇴
      description: 로그인된 사장 계정을 영구 삭제합니다.
      tags: [Auth]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 회원 탈퇴 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  message:
                    type: string
                    example: 회원 탈퇴가 완료되었습니다.
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        example: "5"
                      email:
                        type: string
                        example: owner@example.com
        '403':
          description: 권한 없음 (OWNER 전용)

  /api/v1/owner/cafes/{cafeId}/coupons:
    post:
      tags:
        - Admin Coupons
      summary: 사장님 쿠폰 생성
      description: 사장님이 매장에 프로모션 쿠폰을 생성합니다.
      security:
        - bearerAuth: []
      parameters:
        - name: cafeId
          in: path
          required: true
          description: 쿠폰을 발행할 카페 ID
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - discountType
                - validDays
                - applicableMenuId
              properties:
                discountType:
                  type: string
                  enum: [DISCOUNT, FREE_DRINK, SIZE_UP]
                  example: DISCOUNT
                  description: 쿠폰 유형
                discountValue:
                  type: integer
                  nullable: true
                  example: 1000
                  description: DISCOUNT일 경우 필수
                applicableMenuId:
                  type: integer
                  example: 5
                  description: 쿠폰을 적용할 메뉴 ID
                usageCondition:
                  type: string
                  nullable: true
                  example: "1만원 이상 구매 시"
                startDate:
                  type: string
                  format: date-time
                  nullable: true
                  example: "2025-08-10T00:00:00.000Z"
                endDate:
                  type: string
                  format: date-time
                  nullable: true
                  example: "2025-08-31T23:59:59.000Z"
      responses:
        '201':
          description: 쿠폰 생성 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 쿠폰이 성공적으로 생성되었습니다.
                  data:
                    $ref: '#/components/schemas/CouponTemplate'
        '400':
          description: 유효하지 않은 요청
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    get:
      tags:
        - Admin Coupons
      summary: 사장님 쿠폰 목록 조회
      description: 사장님이 등록한 쿠폰 목록을 조회합니다. `type` 쿼리로 필터링할 수 있습니다.
      security:
        - bearerAuth: []
      parameters:
        - name: cafeId
          in: path
          required: true
          schema:
            type: integer
          description: 쿠폰을 조회할 카페 ID
        - name: type
          in: query
          required: false
          description: 필터링할 쿠폰 유형
          schema:
            type: string
            enum: [DISCOUNT, FREE_DRINK, SIZE_UP]
      responses:
        '200':
          description: 쿠폰 목록 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 12
                        name:
                          type: string
                          example: 아메리카노 1000원 할인, 1만원 이상 구매 시
                        status:
                          type: string
                          enum: [발행 중, 종료됨]
                          example: 발행 중
                        usedCount:
                          type: integer
                          example: 5
                        startDate:
                          type: string
                          example: "2025-08-10"
                        endDate:
                          type: string
                          example: "2025-08-31"
                        discountType:
                          type: string
                          enum: [DISCOUNT, FREE_DRINK, SIZE_UP]
                          example: DISCOUNT
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'


  /api/v1/owner/cafes/{cafeId}/coupons/{couponId}/terminate:
    patch:
      tags:
        - Admin Coupons
      summary: 쿠폰 발급 종료
      description: 사장님이 특정 쿠폰의 발급을 종료합니다. (isActive → false)
      security:
        - bearerAuth: []
      parameters:
        - name: cafeId
          in: path
          required: true
          description: 카페 ID
          schema:
            type: integer
        - name: couponId
          in: path
          required: true
          description: 종료할 쿠폰 ID
          schema:
            type: integer
      responses:
        '200':
          description: 쿠폰 발급 종료 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 쿠폰 발급이 종료되었습니다.
                  data:
                    $ref: '#/components/schemas/CouponTemplate'
        '404':
          description: 해당 쿠폰을 찾을 수 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: 인증 실패
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  
  /api/v1/owner/cafe/{cafeId}/challenges/available:
    get:
      tags:
        - Admin Challenges
      summary: 챌린지 목록 조회
      description: 기간이 지나지 않은 모든 챌린지를 조회합니다.
      security:
        - bearerAuth: []
      parameters:
        - name: cafeId
          in: path
          required: true
          schema:
            type: integer
      responses:
        200:
          description: 챌린지 목록 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                        title:
                          type: string
                        thumbnailUrl:
                          type: string
                        startDate:
                          type: string
                          format: date
                        endDate:
                          type: string
                          format: date
                        isJoined:
                          type: boolean

  /api/v1/owner/cafe/{cafeId}/challenges/{challengeId}/join:
    post:
      tags:
        - Admin Challenges
      summary: 챌린지 참여
      description: 사장님이 해당 챌린지에 참여합니다.
      security:
        - bearerAuth: []
      parameters:
        - name: cafeId
          in: path
          required: true
          schema:
            type: integer
        - name: challengeId
          in: path
          required: true
          schema:
            type: integer
      responses:
        200:
          description: 챌린지 참여 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  message:
                    type: string
                    example: "텀블러 챌린지 참여 완료"

  /api/v1/owner/cafe/{cafeId}/challenges/in-progress:
    get:
      tags:
        - Admin Challenges
      summary: 진행 중인 챌린지 조회
      description: 현재 진행 중인 챌린지 목록을 조회합니다.
      security:
        - bearerAuth: []
      parameters:
        - name: cafeId
          in: path
          required: true
          schema:
            type: integer
      responses:
        200:
          description: 진행 중인 챌린지 목록 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                        title:
                          type: string
                        thumbnailUrl:
                          type: string
                        startDate:
                          type: string
                        endDate:
                          type: string
                        participantCount:
                          type: integer
                        completedCount:
                          type: integer

  /api/v1/owner/cafe/{cafeId}/challenges/past:
    get:
      tags:
        - Admin Challenges
      summary: 참여 완료된 과거 챌린지 조회
      description: 사장님이 참여했던 챌린지 중, 종료된 챌린지를 조회합니다.
      security:
        - bearerAuth: []
      parameters:
        - name: cafeId
          in: path
          required: true
          schema:
            type: integer
      responses:
        200:
          description: 과거 챌린지 목록 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                        title:
                          type: string
                        thumbnailUrl:
                          type: string
                        startDate:
                          type: string
                        endDate:
                          type: string
                        participantCount:
                          type: integer
                        completedCount:
                          type: integer
  
  /api/v1/owner/cafe/{cafeId}/challenges/{challengeId}:
    get:
      tags:
        - Admin Challenges
      summary: 챌린지 상세 조회
      description: 챌린지의 상세 정보(설명, 이미지, 참여자 수 등)를 조회합니다.
      security:
        - bearerAuth: []
      parameters:
        - name: cafeId
          in: path
          required: true
          schema:
            type: integer
        - name: challengeId
          in: path
          required: true
          schema:
            type: integer
      responses:
        200:
          description: 챌린지 상세 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  data:
                    type: object
                    properties:
                      id:
                        type: integer
                      title:
                        type: string
                      thumbnailUrl:
                        type: string
                      description:
                        type: string
                      goalDescription:
                        type: string
                      startDate:
                        type: string
                        format: date
                      endDate:
                        type: string
                        format: date
                      rewardDetail:
                        type: string
                      participantCount:
                        type: integer
                      completedCount:
                        type: integer

  /api/v1/owner/cafes/{cafeId}/challenges/statistics:
    get:
      tags:
        - Admin Challenges
      summary: 챌린지 통계 조회
      description: 매장의 챌린지 참여 수, 참여자 수, 혜택 수령자 수, 챌린지를 통한 판매 건 수를 조회합니다.
      security:
        - bearerAuth: []
      parameters:
        - name: cafeId
          in: path
          required: true
          schema:
            type: integer
          description: 매장 ID
      responses:
        '200':
          description: 챌린지 통계 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  data:
                    type: object
                    properties:
                      participatedChallengeCount:
                        type: integer
                        example: 5
                      totalParticipantCount:
                        type: integer
                        example: 238
                      completedUserCount:
                        type: integer
                        example: 200
                      challengeRelatedSalesCount:
                        type: integer
                        example: 32

  /api/v1/owner/users/search:
    get:
      summary: 전화번호로 고객 조회 (스탬프북 자동 생성 포함)
      description: |
        - 전화번호로 고객을 검색합니다.  
        - 현재 카페에서 진행 중인 스탬프북이 없으면 자동으로 새 스탬프북을 생성합니다.  
        - 반환된 `actionToken`은 즉시 스탬프 적립 API에 사용할 수 있습니다.  
      tags:
        - Owner Users
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: phone
          required: true
          schema:
            type: string
            example: "01012345678"
          description: 하이픈(-) 없이 입력한 전화번호
      responses:
        '200':
          description: 고객 정보 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: string
                    nullable: true
                    example: null
                  success:
                    type: object
                    properties:
                      userId:
                        type: integer
                        example: 1
                      nickname:
                        type: string
                        example: 도장냥이
                      phone:
                        type: string
                        example: 010-1234-5678
                      stamp:
                        type: object
                        properties:
                          totalCount:
                            type: integer
                            description: 전체 스탬프북 개수
                            example: 5
                          currentStampBook:
                            type: object
                            nullable: true
                            properties:
                              stampBookId:
                                type: integer
                                example: 12
                              currentCount:
                                type: integer
                                example: 0
                              goalCount:
                                type: integer
                                example: 10
                              progressRate:
                                type: integer
                                example: 0
                              expiresAt:
                                type: string
                                format: date-time
                                example: 2025-09-12T00:00:00.000Z
                              daysLeft:
                                type: integer
                                example: 30
                      point:
                        type: object
                        properties:
                          total:
                            type: integer
                            example: 1200
                      actionToken:
                        type: string
                        description: 스탬프 적립 시 사용 가능한 액션 토큰
                        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
              example:
                resultType: SUCCESS
                error: null
                success:
                  userId: 1
                  nickname: 도장냥이
                  phone: 010-1234-5678
                  stamp:
                    totalCount: 5
                    currentStampBook:
                      stampBookId: 12
                      currentCount: 0
                      goalCount: 10
                      progressRate: 0
                      expiresAt: "2025-09-12T00:00:00.000Z"
                      daysLeft: 30
                  point:
                    total: 1200
                  actionToken: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        '400':
          description: 잘못된 요청
          content:
            application/json:
              schema:
                type: object
                properties:
                  reason:
                    type: string
                example:
                  reason: 전화번호 입력 누락
        '404':
          description: 고객을 찾을 수 없음
          content:
            application/json:
              schema:
                type: object
                properties:
                  reason:
                    type: string
                example:
                  reason: 해당 전화번호의 고객을 찾을 수 없습니다.

  /owner/cafes/{cafeId}/notification:
    post:
      tags:
        - Owner
      summary: 사장님이 카페 고객에게 알림 메시지 전송
      description: |
        지정한 카페의 **알림 허용 설정된 고객**에게 사장님 메시지를 전송합니다.
        - 메시지는 최대 500자까지 입력 가능
        - JWT 인증 필요
        - 사장님 권한(OWNER) 필요
        - URL의 `cafeId`는 본인 카페와 일치해야 함
      security:
        - bearerAuth: []
      parameters:
        - name: cafeId
          in: path
          required: true
          description: 카페 ID
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                  maxLength: 500
                  example: "오늘부터 아메리카노 1+1 이벤트 진행합니다! 🎉"
              required:
                - message
      responses:
        '200':
          description: 알림 메시지 전송 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: object
                    nullable: true
                    example: null
                  success:
                    type: string
                    example: "알림 메시지가 전송되었습니다. (대상 15명)"
        '200(empty)':
          description: 발송 대상이 없을 경우
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: object
                    nullable: true
                    example: null
                  success:
                    type: string
                    example: "발송 대상 사용자가 없습니다. (조건을 충족하는 유저 0명)"
        '400':
          description: 잘못된 요청 (유효하지 않은 cafeId, message 누락, 500자 초과)
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: FAIL
                  error:
                    type: object
                    example:
                      errorCode: UNKNOWN
                      reason: "알림 메시지를 입력해주세요."
                      data: null
                  success:
                    type: string
                    nullable: true
                    example: null
        '403':
          description: 권한 없음 (사장님 아님 / 본인 카페 아님)
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: FAIL
                  error:
                    type: object
                    example:
                      errorCode: FORBIDDEN
                      reason: "본인 카페에만 알림을 보낼 수 있습니다."
                      data: null
                  success:
                    type: string
                    nullable: true
                    example: null
        '404':
          description: 카페를 찾을 수 없음
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: FAIL
                  error:
                    type: object
                    example:
                      errorCode: UNKNOWN
                      reason: "해당 카페를 찾을 수 없습니다."
                      data: null
                  success:
                    type: string
                    nullable: true
                    example: null

  /api/v1/owner/users/{userId}/stamps:
    post:
      summary: 특정 사용자에게 스탬프 1개 적립
      description: |
        점주(OWNER)가 특정 사용자에게 수동으로 스탬프를 1개 적립합니다.  
        요청 시 `x-action-token` 헤더를 포함해야 하며, 해당 토큰의 목적(`purpose`)은 `ADD_STAMP`여야 합니다.
        
        - 현재 진행 중인 스탬프북이 없으면 새로 생성합니다. (14일 만료)
        - 목표 개수를 초과하면 적립이 불가합니다.
        - 스탬프북 생성 시 `startedAt`, `status`(active), `expiresAt`이 설정됩니다.
      tags:
        - Owner Users
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: integer
          description: 스탬프를 적립할 사용자 ID
        - in: header
          name: x-action-token
          required: true
          schema:
            type: string
          description: 발급된 액션 토큰 (purpose: ADD_STAMP)
      responses:
        '200':
          description: 스탬프 적립 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: SUCCESS
                  error:
                    type: string
                    nullable: true
                    example: null
                  success:
                    type: object
                    properties:
                      stampBookId:
                        type: integer
                        example: 15
                      currentCount:
                        type: integer
                        example: 5
                      goalCount:
                        type: integer
                        example: 10
                      isCompleted:
                        type: boolean
                        example: false
        '400':
          description: 잘못된 요청 (유효하지 않은 사용자 ID 등)
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: FAIL
                  error:
                    type: object
                    properties:
                      errorCode:
                        type: string
                        example: BAD_REQUEST
                      reason:
                        type: string
                        example: 유효하지 않은 사용자 ID입니다.
                      data:
                        type: string
                        nullable: true
                        example: null
                  success:
                    type: string
                    nullable: true
                    example: null
        '401':
          description: 인증 실패 (JWT 또는 액션 토큰 누락/유효하지 않음)
        '403':
          description: 카페 불일치 또는 권한 없음
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: FAIL
                  error:
                    type: object
                    properties:
                      errorCode:
                        type: string
                        example: CAFE_REQUIRED
                      reason:
                        type: string
                        example: 사장님 토큰에 카페 정보가 없습니다.
                      data:
                        type: string
                        nullable: true
                        example: null
                  success:
                    type: string
                    nullable: true
                    example: null
        '404':
          description: 존재하지 않는 사용자
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: FAIL
                  error:
                    type: object
                    properties:
                      errorCode:
                        type: string
                        example: USER_NOT_FOUND
                      reason:
                        type: string
                        example: 존재하지 않는 사용자입니다.
                      data:
                        type: string
                        nullable: true
                        example: null
                  success:
                    type: string
                    nullable: true
                    example: null
        '409':
          description: 이미 목표를 달성한 스탬프북
          content:
            application/json:
              schema:
                type: object
                properties:
                  resultType:
                    type: string
                    example: FAIL
                  error:
                    type: object
                    properties:
                      errorCode:
                        type: string
                        example: STAMPBOOK_ALREADY_COMPLETED
                      reason:
                        type: string
                        example: 이미 목표를 달성한 스탬프북입니다.
                      data:
                        type: string
                        nullable: true
                        example: null
                  success:
                    type: string
                    nullable: true
                    example: null

  /api/v1/owner/qrs/verify:
    post:
      tags: [Owner Users]
      summary: QR로 고객 식별 (userId 기반)
      description: 프론트가 QR을 해석해 전달한 userId로, 사장님 카페 컨텍스트에서 고객의 스탬프/포인트/보유 쿠폰/참여 중 챌린지를 조회합니다. 컨트롤러/경로명은 verifyQRToken을 유지합니다.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VerifyQRTokenRequest'
            example:
              userId: 123
      responses:
        '200':
          description: 고객 정보 조회 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VerifyQRTokenSuccessResponse'
              example:
                resultType: SUCCESS
                error: null
                success:
                  userId: 123
                  nickname: "루피25"
                  stamp:
                    totalCount: 28
                    currentStampBook:
                      stampBookId: 45
                      currentCount: 7
                      goalCount: 10
                  point:
                    total: 326
                  availableCoupons:
                    - userCouponId: 901
                      name: "아메리카노 200원 할인쿠폰"
                      description: "아메리카노 200원 할인"
                      expiredAt: "2025-09-15T00:00:00.000Z"
                  ongoingChallenges:
                    - challengeId: 33
                      title: "친구와 함께하는 카공 챌린지"
                      expiredAt: "2025-09-15T00:00:00.000Z"
        '400':
          description: 잘못된 요청 (userId 누락 등)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                resultType: ERROR
                error:
                  code: BAD_REQUEST
                  message: "userId가 필요합니다."
                success: null
        '403':
          description: 사장님 토큰에 카페 정보 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                resultType: ERROR
                error:
                  code: CAFE_REQUIRED
                  message: "사장님 토큰에 카페 정보가 없습니다."
                success: null
        '404':
          description: 고객 없음
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                resultType: ERROR
                error:
                  code: USER_NOT_FOUND
                  message: "해당 고객 정보를 찾을 수 없습니다."
                success: null

  /api/v1/owner/users/{userId}/points/use:
    post:
        summary: 포인트 전액 사용 (잔액 0 처리)
        description: 해당 사용자의 보유 포인트를 모두 사용 처리합니다. 원장(earned+refunded−spent) 합계를 0으로 만드는 `spent` 트랜잭션 1건을 생성합니다.
        tags: [Owner User]
        security:
          - bearerAuth: []
        parameters:
          - in: path
            name: userId
            required: true
            schema:
              type: integer
            description: 포인트를 사용할 사용자 ID
        requestBody:
          required: false
        responses:
          '200':
            description: 포인트 전액 사용 완료
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    status:
                      type: string
                      example: SUCCESS
                    code:
                      type: integer
                      example: 200
                    message:
                      type: string
                      example: 포인트 전액 사용 완료
                    data:
                      $ref: '#/components/schemas/UseAllPointsResult'
          '400':
            description: 사용 가능한 포인트가 없음 등 잘못된 요청
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
                examples:
                  noBalance:
                    summary: 잔액 없음
                    value:
                      status: FAIL
                      code: 400
                      message: 사용 가능한 포인트가 없습니다.
                      data: null
          '401':
            description: 인증 실패(토큰 누락/만료)
          '403':
            description: 권한 없음(OWNER 아님 등)
          '404':
            description: 사용자 미존재(서비스 정책에 따라 사용 시)
          '500':
            description: 서버 오류

  /api/v1/owner/users/{userId}/coupons/{couponId}:
    patch:
      summary: 쿠폰 사용 처리
      description: 지정한 사용자 쿠폰을 사용 처리합니다. 조건(본인 소유, 사용 전, 미만료, status=active)을 만족할 때 `usedAt`을 현재 시각으로 설정하고 `status`를 `used`로 변경합니다.
      tags: [Owner]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: integer
          description: 쿠폰을 사용할 사용자 ID
        - in: path
          name: couponId
          required: true
          schema:
            type: integer
          description: 사용 처리할 사용자 쿠폰 ID
      responses:
        '200':
          description: 쿠폰 사용 처리 완료
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: SUCCESS
                  code:
                    type: integer
                    example: 200
                  message:
                    type: string
                    example: 쿠폰 사용 처리 완료
                  data:
                    type: object
                    properties:
                      userCouponId:
                        type: integer
                        example: 123
                      usedAt:
                        type: string
                        format: date-time
                        example: 2025-08-12T06:20:00.000Z
        '400':
          description: 사용 불가(이미 사용/만료/조건 불일치)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                unusable:
                  summary: 사용 가능한 쿠폰이 없음
                  value:
                    status: FAIL
                    code: 400
                    message: 사용 가능한 쿠폰이 없습니다.
                    data: null
        '401':
          description: 인증 실패
        '403':
          description: 권한 없음 (OWNER 아님 등) # *카페 제약을 검증한다면 여기로 반환
        '404':
          description: 쿠폰 미존재(정책에 따라 사용 시)
        '500':
          description: 서버 오류

  /api/v1/owner/users/{userId}/challenges/{challengeId}/verify:
    post:
      summary: 챌린지 인증 처리 (해당 챌린지에서 3회 완료 시 보상 지급)
      description: |
        사장님 카페에서 특정 사용자의 챌린지를 인증 처리합니다.
        - 조건: 사장님 토큰의 카페와 챌린지 참여 시 등록된 카페가 일치해야 함
        - 3회째 인증 시 보상(예: 포인트)을 지급합니다.
      tags: [Owner, Challenge]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: integer
          description: 인증할 사용자 ID
        - in: path
          name: challengeId
          required: true
          schema:
            type: integer
          description: 인증할 챌린지 ID
      requestBody:
        required: false
      responses:
        '200':
          description: 챌린지 인증 완료
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: SUCCESS
                  code:
                    type: integer
                    example: 200
                  message:
                    type: string
                    example: 챌린지 인증 완료
                  data:
                    type: object
                    properties:
                      completedAt:
                        type: string
                        format: date-time
                        example: 2025-08-12T06:30:00.000Z
                      completedCount:
                        type: integer
                        example: 3
                      milestoneRewarded:
                        type: integer
                        example: 500
        '400':
          description: 잘못된 요청(이미 완료, 인증 조건 불일치 등)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                alreadyCompleted:
                  summary: 이미 완료됨
                  value:
                    status: FAIL
                    code: 400
                    message: 이미 완료되었거나 인증 조건이 맞지 않습니다.
                    data: null
        '401':
          description: 인증 실패(토큰 누락/만료)
        '403':
          description: 권한 없음(사장님 카페 불일치 등)
        '404':
          description: 챌린지 참여 이력 없음
        '500':
          description: 서버 오류



components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    UserProfile:
      type: object
      properties:
        id:
          type: string
          example: "2"
        email:
          type: string
          example: test@example.com
        phoneNumber:
          type: string
          example: "01012345678"
        nickname:
          type: string
          example: 테스터
        role:
          type: string
          enum: [CUSTOMER, OWNER]
          example: CUSTOMER
        status:
          type: string
          enum: [active, inactive]
          example: active
        allowKakaoAlert:
          type: boolean
          example: false
        profileImageUrl:
          type: string
          nullable: true
          example: null
        fcmToken:
          type: string
          nullable: true
          example: null
        createdAt:
          type: string
          format: date-time
          example: "2025-07-01T10:00:00.000Z"
        updatedAt:
          type: string
          format: date-time
          example: "2025-07-17T16:30:00.000Z"
        inactivedAt:
          type: string
          format: date-time
          nullable: true
          example: null

    PointTransaction:
      type: object
      properties:
        id:
          type: integer
          example: 12
        point:
          type: integer
          example: 50
        type:
          type: string
          example: EARN
        description:
          type: string
          example: 스탬프 적립 보상
        createdAt:
          type: string
          format: date-time
          example: "2025-08-14T07:12:34.000Z"
        cafeName:
          type: string
          nullable: true
          example: 카페 루피
  
    OwnerProfile:
      type: object
      properties:
        id:
          type: string
          example: "4"
        email:
          type: string
          example: testOwner@example.com
        phoneNumber:
          type: string
          example: "01012345679"
        nickname:
          type: string
          example: 테스터(사장)
        role:
          type: string
          enum: [CUSTOMER, OWNER]
          example: OWNER
        status:
          type: string
          enum: [active, inactive]
          example: active
        allowKakaoAlert:
          type: boolean
          example: false
        profileImageUrl:
          type: string
          nullable: true
          example: null
        fcmToken:
          type: string
          nullable: true
          example: null
        createdAt:
          type: string
          format: date-time
          example: "2025-07-01T10:00:00.000Z"
        updatedAt:
          type: string
          format: date-time
          example: "2025-07-17T16:30:00.000Z"
        inactivedAt:
          type: string
          format: date-time
          nullable: true
          example: null
  
    LoginUserProfile:
      type: object
      properties:
        id:
          type: string
          example: "1"
        email:
          type: string
          example: test@example.com
        nickname:
          type: string
          example: 테스터
        currentRole:
          type: string
          enum: [CUSTOMER, OWNER]
          example: CUSTOMER


    UserAgreementRequest:
      type: object
      required:
        - termsAgreed
        - privacyPolicyAgreed
        - marketingAgreed
        - locationPermission
      properties:
        termsAgreed:
          type: boolean
          example: true
        privacyPolicyAgreed:
          type: boolean
          example: true
        marketingAgreed:
          type: boolean
          example: false
        locationPermission:
          type: boolean
          example: true

    UserKeywordPreferenceRequest:
      type: object
      required:
        - preferredKeywords
      properties:
        preferredKeywords:
          type: array
          items:
            type: string
          description: 사용자가 선택한 키워드 문자열 목록
          example:
            - 1인석
            - 노트북
            - 디카페인
            - 텀블러 할인

    UserAgreementResponse:
      type: object
      properties:
        id:
          type: string
          example: "1"
        userId:
          type: string
          example: "1"
        termsAgreed:
          type: boolean
          example: true
        privacyPolicyAgreed:
          type: boolean
          example: true
        marketingAgreed:
          type: boolean
          example: false
        locationPermission:
          type: boolean
          example: true
        agreedAt:
          type: string
          format: date-time
          example: "2025-07-23T04:40:50.464Z"

    UserPreferredAreaRequest:
      type: object
      required:
        - preferredArea
      properties:
        preferredArea:
          type: string
          example: 서울 마포구 신촌동

    KakaoAlertSettingRequest:
      type: object
      required:
        - allowKakaoAlert
      properties:
        allowKakaoAlert:
          type: boolean
          example: true

    BookmarkedCafe:
      type: object
      properties:
        id:
          type: string
          example: "1"
        name:
          type: string
          example: 테스트카페
        address:
          type: string
          example: 서울시 마포구 양화로 123
        region:
          type: string
          example: 마포구
        latitude:
          type: number
          example: 37.5509
        longitude:
          type: number
          example: 126.9143
        description:
          type: string
          nullable: true
          example: null
        keywords:
          type: array
          nullable: true
          items:
            type: string
          example: null
        status:
          type: string
          enum: [active, inactive, deleted]
          example: active
        createdAt:
          type: string
          format: date-time
          example: "2025-07-19T09:21:39.933Z"
        updatedAt:
          type: string
          format: date-time
          example: "2025-07-19T09:20:09.040Z"
    
    CafeSearchResponse:
      type: object
      required:
        - resultType
        - error
        - success
      properties:
        resultType:
          type: string
          enum: [SUCCESS, ERROR]
          description: 응답 결과 타입
        error:
          type: object
          nullable: true
          description: 에러 정보 (성공시 null)
        success:
          $ref: '#/components/schemas/CafeSearchInfo'
          nullable: true
          description: 카페 정보 (실패시 null)

    CafeSearchErrorResponse:
      type: object
      required:
        - resultType
        - error
        - success
      properties:
        resultType:
          type: string
          enum: [ERROR]
          description: 응답 결과 타입
        error:
          $ref: '#/components/schemas/CafeSearchErrorInfo'
          description: 에러 정보
        success:
          type: object
          nullable: true
          description: 성공 데이터 (에러시 null)

    CafeSearchErrorInfo:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: 에러 코드
          example: "INVALID_PARAMETER"
        message:
          type: string
          description: 에러 메시지
          example: "유효하지 않은 파라미터입니다"

    CafeSearchInfo:
      type: object
      required:
        - id
        - name
        - keywords
        - photos
        - distance
      properties:
        id:
          type: string
          description: 카페 고유 ID
          example: "1"
        name:
          type: string
          description: 카페 이름
          example: "로스터리 카페"
        keywords:
          type: array
          items:
            type: string
          description: 카페 키워드 목록
          example: ["커피", "로스팅"]
        photos:
          type: array
          items:
            $ref: '#/components/schemas/CafeSearchPhoto'
          description: 카페 사진 목록
        distance:
          type: integer
          description: 현재 위치에서 카페까지의 거리 (미터)
          example: 100

    CafeSearchPhoto:
      type: object
      required:
        - id
        - url
        - displayOrder
      properties:
        id:
          type: string
          description: 사진 고유 ID
          example: "1"
        url:
          type: string
          format: uri
          description: 사진 URL
          example: "https://example.com/photos/roastery-exterior.jpg"
        displayOrder:
          type: integer
          description: 사진 표시 순서
          example: 1
          minimum: 1

    CafeMapSearchResponse:
      type: object
      required:
        - resultType
        - error
        - success
      properties:
        resultType:
          type: string
          enum: [SUCCESS, ERROR]
          description: 응답 결과 타입
        error:
          type: object
          nullable: true
          description: 에러 정보 (성공시 null)
        success:
          $ref: '#/components/schemas/CafeMapSearchResult'
          nullable: true
          description: 검색 결과 (실패시 null)

    CafeMapSearchErrorResponse:
      type: object
      required:
        - resultType
        - error
        - success
      properties:
        resultType:
          type: string
          enum: [ERROR]
          description: 응답 결과 타입
        error:
          $ref: '#/components/schemas/CafeMapSearchErrorInfo'
          description: 에러 정보
        success:
          type: object
          nullable: true
          description: 성공 데이터 (에러시 null)

    CafeMapSearchErrorInfo:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: 에러 코드
          example: "INVALID_PARAMETER"
        message:
          type: string
          description: 에러 메시지
          example: "유효하지 않은 파라미터입니다"

    CafeMapSearchResult:
      type: object
      required:
        - cafes
        - totalCount
        - searchRadius
        - zoomLevel
        - center
      properties:
        cafes:
          type: array
          items:
            $ref: '#/components/schemas/CafeMapSearchItem'
          description: 검색된 카페 목록
        totalCount:
          type: integer
          description: 총 검색된 카페 수
          example: 3
        searchRadius:
          type: integer
          description: 검색 반경 (미터)
          example: 320
        zoomLevel:
          type: string
          description: 지도 줌 레벨
          example: "3"
        center:
          $ref: '#/components/schemas/CafeMapSearchCenter'
          description: 검색 중심점 좌표

    CafeMapSearchItem:
      type: object
      required:
        - id
        - name
        - latitude
        - longitude
        - isBookmarked
      properties:
        id:
          type: integer
          description: 카페 고유 ID
          example: 10
        name:
          type: string
          description: 카페 이름
          example: "스타벅스 강남역점"
        latitude:
          type: number
          format: double
          description: 위도
          example: 37.497175
        longitude:
          type: number
          format: double
          description: 경도
          example: 127.027926
        isBookmarked:
          type: boolean
          description: 북마크 여부
          example: false

    CafeMapSearchCenter:
      type: object
      required:
        - x
        - y
      properties:
        x:
          type: number
          format: double
          description: 중심점 X 좌표 (경도)
          example: 127.027926
        y:
          type: number
          format: double
          description: 중심점 Y 좌표 (위도)
          example: 37.497175

    CafeDetailResponse:
      type: object
      required:
        - resultType
        - error
        - success
      properties:
        resultType:
          type: string
          enum: [SUCCESS, ERROR]
          description: 응답 결과 타입
        error:
          type: object
          nullable: true
          description: 에러 정보 (성공시 null)
        success:
          $ref: '#/components/schemas/CafeDetailResult'
          nullable: true
          description: 카페 상세 정보 (실패시 null)

    CafeDetailErrorResponse:
      type: object
      required:
        - resultType
        - error
        - success
      properties:
        resultType:
          type: string
          enum: [ERROR]
          description: 응답 결과 타입
        error:
          $ref: '#/components/schemas/CafeDetailErrorInfo'
          description: 에러 정보
        success:
          type: object
          nullable: true
          description: 성공 데이터 (에러시 null)

    CafeDetailErrorInfo:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: 에러 코드
          example: "UNAUTHORIZED"
        message:
          type: string
          description: 에러 메시지
          example: "유효하지 않은 토큰입니다"

    CafeDetailResult:
      type: object
      required:
        - cafe
        - photos
        - menu
        - coupons
        - stampBook
        - bookmark
      properties:
        cafe:
          $ref: '#/components/schemas/CafeDetailInfo'
        photos:
          type: array
          items:
            $ref: '#/components/schemas/CafeDetailPhoto'
          description: 카페 사진 목록
        menu:
          type: array
          items:
            $ref: '#/components/schemas/CafeDetailMenuItem'
          description: 메뉴 목록
        coupons:
          type: array
          items:
            $ref: '#/components/schemas/CafeDetailCoupon'
          description: 쿠폰 목록
        stampBook:
          $ref: '#/components/schemas/CafeDetailStampBook'
          description: 스탬프북 정보
        bookmark:
          $ref: '#/components/schemas/CafeDetailBookmark'
          description: 북마크 정보

    CafeDetailInfo:
      type: object
      required:
        - id
        - name
        - address
        - businessHours
        - breakTime
        - phone
        - websiteUrl
        - description
        - storeFilters
        - takeOutFilters
        - menuFilters
        - keywords
      properties:
        id:
          type: integer
          description: 카페 고유 ID
          example: 1
        name:
          type: string
          description: 카페 이름
          example: "로스터리 카페"
        address:
          type: string
          description: 카페 주소
          example: "서울시 강남구 테헤란로 123"
        businessHours:
          type: array
          items:
            $ref: '#/components/schemas/CafeDetailBusinessHour'
          description: 영업시간 정보
        breakTime:
          type: string
          description: 브레이크 타임
          example: "14:00~15:00"
        phone:
          type: string
          description: 전화번호
          example: "02-1234-5678"
        websiteUrl:
          type: string
          format: uri
          description: 웹사이트 URL
          example: "https://roastery-cafe.com"
        description:
          type: string
          description: 카페 설명
          example: "신선한 원두를 직접 로스팅하는 스페셜티 커피 전문점입니다."
        storeFilters:
          type: object
          additionalProperties:
            type: boolean
          description: 매장 필터 정보
          example:
            "1인석": true
            "단체석": false
            "노트북석": true
        takeOutFilters:
          type: object
          additionalProperties:
            type: boolean
          description: 테이크아웃 필터 정보
          example:
            "포장 할인": false
            "텀블러 할인": true
        menuFilters:
          type: object
          additionalProperties:
            type: boolean
          description: 메뉴 필터 정보
          example:
            "비건": false
            "디카페인": true
        keywords:
          type: array
          items:
            type: string
          description: 카페 키워드
          example: ["커피", "로스팅"]

    CafeDetailBusinessHour:
      type: object
      required:
        - day
        - isClosed
      properties:
        day:
          type: string
          enum:
            - MONDAY
            - TUESDAY
            - WEDNESDAY
            - THURSDAY
            - FRIDAY
            - SATURDAY
            - SUNDAY
          description: 요일
          example: "MONDAY"
        isClosed:
          type: boolean
          description: 휴무 여부
          example: false
        openTime:
          type: string
          description: 오픈 시간 (isClosed가 false일 때 필수)
          example: "09:00"
        closeTime:
          type: string
          description: 마감 시간 (isClosed가 false일 때 필수)
          example: "21:00"
        breakStart:
          type: string
          description: 브레이크 타임 시작 (선택)
          example: "14:00"
        breakEnd:
          type: string
          description: 브레이크 타임 종료 (선택)
          example: "15:00"

    CafeDetailPhoto:
      type: object
      required:
        - id
        - url
        - displayOrder
      properties:
        id:
          type: integer
          description: 사진 ID
          example: 1
        url:
          type: string
          format: uri
          description: 사진 URL
          example: "https://example.com/photos/roastery-exterior.jpg"
        displayOrder:
          type: integer
          description: 표시 순서
          example: 1

    CafeDetailMenuItem:
      type: object
      required:
        - id
        - name
        - price
        - description
        - imgUrl
        - isSoldOut
      properties:
        id:
          type: integer
          description: 메뉴 ID
          example: 1
        name:
          type: string
          description: 메뉴 이름
          example: "시그니처 아메리카노"
        price:
          type: integer
          description: 가격
          example: 4500
        description:
          type: string
          description: 메뉴 설명
          example: "하우스 블렌드 원두로 추출한 깔끔한 아메리카노"
        imgUrl:
          type: string
          format: uri
          description: 메뉴 이미지 URL
          example: "https://example.com/menu/signature-americano.jpg"
        isSoldOut:
          type: boolean
          description: 품절 여부
          example: false

    CafeDetailCoupon:
      type: object
      required:
        - id
        - name
        - validDays
        - discountType
        - discountValue
        - applicableMenu
        - expiredAt
      properties:
        id:
          type: integer
          description: 쿠폰 ID
          example: 1
        name:
          type: string
          description: 쿠폰 이름
          example: "시그니처 아메리카노 무료"
        validDays:
          type: integer
          description: 유효 기간 (일)
          example: 30
        discountType:
          type: string
          enum: [fixed, percentage]
          description: 할인 타입
          example: "fixed"
        discountValue:
          type: number
          description: 할인 값
          example: 4500
        applicableMenu:
          type: object
          nullable: true
          description: 적용 가능 메뉴
          example: null
        expiredAt:
          type: string
          format: date-time
          description: 만료일시
          example: "2025-12-31T23:59:59.000Z"

    CafeDetailStampBook:
      type: object
      required:
        - id
        - currentCount
        - goalCount
        - expiresAt
        - stampBookId
      properties:
        id:
          type: integer
          description: 스탬프북 ID
          example: 1
        currentCount:
          type: integer
          description: 현재 스탬프 개수
          example: 3
        goalCount:
          type: integer
          description: 목표 스탬프 개수
          example: 10
        expiresAt:
          type: string
          format: date-time
          description: 만료일시
          example: "2025-12-31T23:59:59.000Z"
        stampBookId:
          type: integer
          description: 스탬프북 ID
          example: 1

    CafeDetailBookmark:
      type: object
      required:
        - isBookmarked
      properties:
        isBookmarked:
          type: boolean
          description: 북마크 여부
          example: false

    ErrorResponse:
      type: object
      properties:
        errorCode:
          type: string
          description: 에러 코드 식별자
          example: U001
        reason:
          type: string
          description: 사용자에게 보여줄 에러 메시지
          example: 잘못된 요청입니다.
        data:
          type: object
          nullable: true
          description: 추가적인 에러 관련 데이터
          example: null

    RegisterRequest:
      type: object
      required:
        - email
        - password
        - nickname
        - phoneNumber
        - role
        - allowKakaoAlert
        - agreements
      properties:
        email:
          type: string
          format: email
          default: test@example.com
        password:
          type: string
          format: password
          default: securepassword123
        nickname:
          type: string
          default: 테스터
        phoneNumber:
          type: string
          default: "01012345678"
        role:
          type: string
          enum: [CUSTOMER, OWNER]
          default: CUSTOMER
        allowKakaoAlert:
          type: boolean
          default: true
        agreements:
          type: object
          required:
            - termsAgreed
            - privacyPolicyAgreed
            - marketingAgreed
            - locationPermission
          properties:
            termsAgreed:
              type: boolean
              default: true
            privacyPolicyAgreed:
              type: boolean
              default: true
            marketingAgreed:
              type: boolean
              default: false
            locationPermission:
              type: boolean
              default: true

    LoginRequest:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
          example: test@example.com
        password:
          type: string
          format: password
          example: securepassword123
        role:
          type: string
          enum: [CUSTOMER, OWNER]
          example: CUSTOMER

    FcmTokenRequest:
      type: object
      required:
        - fcmToken
      properties:
        fcmToken:
          type: string
          example: abc123xyz456

    PhoneVerificationRequest:
      type: object
      required:
        - idToken
        - userId
      properties:
        idToken:
          type: string
          description: Firebase에서 발급받은 ID 토큰
        userId:
          type: integer
          description: 백엔드에서 생성된 사용자 ID
    
    NicknameUpdateRequest:
      type: object
      required:
        - nickname
      properties:
        nickname:
          type: string
          example: 새로운닉네임

    BookmarkRequest:
      type: object
      required:
        - cafeId
      properties:
        cafeId:
          type: integer
          example: 1

    ChallengeListItem:
      type: object
      properties:
        id:
          type: integer
        title:
          type: string
        description:
          type: string
        thumbnailUrl:
          type: string
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        isParticipated:
          type: boolean

    ChallengeListResponse:
      type: array
      items:
        $ref: '#/components/schemas/ChallengeListItem'

    ChallengeAvailableCafe:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        address:
          type: string
        region1DepthName:
          type: string
        region2DepthName:
          type: string
        region3DepthName:
          type: string

    ChallengeDetail:
      type: object
      properties:
        id:
          type: integer
        title:
          type: string
        description:
          type: string
        thumbnailUrl:
          type: string
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        goalDescription:
          type: string
        goalCount:
          type: integer
        rewardPoint:
          type: integer
        isParticipated:
          type: boolean
        availableCafes:
          type: array
          items:
            $ref: '#/components/schemas/ChallengeAvailableCafe'

    MyChallengeListItem:
      type: object
      properties:
        id:
          type: integer
        title:
          type: string
        thumbnailUrl:
          type: string
        tag:
          type: string
          nullable: true
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date

    MyChallengeListResponse:
      type: array
      items:
        $ref: '#/components/schemas/MyChallengeListItem'

    StampBookListSuccessResponse:
      type: object
      properties:
        status: { type: string, example: SUCCESS }
        code: { type: integer, example: 200 }
        message: { type: string, example: 스탬프북 목록 조회 성공 }
        data:
          $ref: '#/components/schemas/StampBookListPayload'

    StampBookListPayload:
      type: object
      properties:
        totalCount: { type: integer, example: 6 }
        sortBy:
          type: string
          description: 실제 적용된 정렬 기준
          example: shortestDeadline
        items:
          type: array
          items:
            $ref: '#/components/schemas/StampBookListItem'

    StampBookListItem:
      type: object
      properties:
        id: { type: integer, example: 1 }
        cafe:
          $ref: '#/components/schemas/CafeSummary'
        currentCount: { type: integer, example: 4 }
        goalCount: { type: integer, example: 10 }
        status:
          type: string
          description: 진행 중 리스트는 항상 `active`로 반환됩니다.
          enum: [active, expired, completed, converted]
          example: active
        expiresAt:
          type: string
          format: date-time
          example: '2025-08-19T02:23:34.000Z'
        remainCount:
          type: integer
          description: goalCount - currentCount (최소 0)
          example: 6
        progressRatio:
          type: number
          format: float
          description: currentCount / goalCount
          example: 0.4
        progressPercent:
          type: integer
          description: round(progressRatio * 100), 최대 100
          example: 40
        isExpired:
          type: boolean
          description: KST 00:00 기준 만료 여부
          example: false
        isExpiringSoon:
          type: boolean
          description: KST 00:00 기준 D-day ≤ 3 (오늘 포함)
          example: true
        daysUntilExpiration:
          type: integer
          description: KST 00:00 기준 만료일까지 남은 일수 (오늘 0, 음수면 만료)
          example: 3

    CafeSummary:
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          example: "카페 위니 이대점"
        address:
          type: string
          example: "서울 서대문구 어딘가 2"
        image:
          type: string
          nullable: true
          example: "https://cdn.example.com/cafes/1-thumb.jpg"


    Stamp:
      type: object
      properties:
        id:
          type: integer
          example: 12
        stampedAt:
          type: string
          format: date-time
          example: "2025-07-31T08:15:30.000Z"
        stampImageUrl:
          type: string
          nullable: true
          example: "https://cdn.loopy.com/stamps/12.png"
        source:
          type: string
          example: "QR"
        note:
          type: string
          nullable: true
          example: "QR 인식이 잘 안됐어요"
        latitude:
          type: number
          format: float
          nullable: true
          example: 37.5656
        longitude:
          type: number
          format: float
          nullable: true
          example: 126.9784


    StampBookDetailSuccessResponse:
      type: object
      properties:
        status: { type: string, example: SUCCESS }
        code: { type: integer, example: 200 }
        message: { type: string, example: 스탬프북 상세 조회 성공 }
        data:
          $ref: '#/components/schemas/StampBookDetail'

    StampBookDetail:
      type: object
      properties:
        id: { type: integer, example: 12, description: 스탬프북 고유 ID }
        cafe:
          type: object
          description: 스탬프북이 속한 카페 정보
          properties:
            id: { type: integer, example: 5 }
            name: { type: string, example: 카페 위니 }
            address: { type: string, example: 서울 서대문구 이화여대길 12 }
            image: { type: string, nullable: true, example: https://cdn.example.com/cafes/5-thumb.jpg }
        round: { type: integer, description: 몇 번째 스탬프북인지(회차), example: 2 }
        goalCount: { type: integer, example: 10 }
        currentCount: { type: integer, example: 6 }
        stampsCount: { type: integer, description: stamps 배열 길이(참고용), example: 6 }
        progressPercent: { type: integer, description: 진행률(0~100, 반올림), example: 60 }
        status:
          type: string
          description: 스키마(enum) 기준 소문자
          enum: [active, expired, completed, converted]
          example: active
        isCompleted: { type: boolean, example: false }
        rewardDetail:
          type: string
          description: 스탬프 목표 달성 시 제공되는 보상 문구
          example: 스탬프 10개 모으면 아메리카노 한 잔 무료
        selectedRewardType:
          type: string
          nullable: true
          enum: [DISCOUNT, SIZE_UP, FREE_DRINK]
          example: FREE_DRINK
        selectedRewardMeta:
          type: object
          nullable: true
          description: 리워드 파라미터(JSON)
          example: null
        startedAt: { type: string, format: date-time, example: '2025-07-01T00:00:00.000Z' }
        lastVisitedAt: { type: string, format: date-time, nullable: true, example: '2025-08-09T14:20:00.000Z' }
        expiresAt: { type: string, format: date-time, example: '2025-08-15T00:00:00.000Z' }
        extendedAt: { type: string, format: date-time, nullable: true, example: '2025-08-20T00:00:00.000Z' }
        expiredAt: { type: string, format: date-time, nullable: true, example: null }
        completedAt: { type: string, format: date-time, nullable: true, example: null }
        convertedAt: { type: string, format: date-time, nullable: true, example: null }
        createdAt: { type: string, format: date-time, example: '2025-07-01T00:00:00.000Z' }
        updatedAt: { type: string, format: date-time, example: '2025-08-10T00:00:00.000Z' }
        stamps:
          type: array
          description: 스탬프 적립 내역(시간순 정렬)
          items:
            type: object
            properties:
              id: { type: integer, example: 101 }
              stampedAt: { type: string, format: date-time, example: '2025-08-09T14:20:00.000Z' }
              stampImageUrl: { type: string, example: 'https://cdn.example.com/stamps/stamp1.png' }
              source: { type: string, example: QR }
              note: { type: string, nullable: true, example: null }
              latitude: { type: number, example: 37.561234 }
              longitude: { type: number, example: 126.946123 }
        isExpiringSoon: { type: boolean, example: true }
        isExpired: { type: boolean, example: false }
        daysUntilExpiration:
          type: integer
          description: KST 00:00 기준 만료일까지 남은 일수 (오늘 0, 음수면 만료)
          example: 4


    ExpiringStampBooksSuccessResponse:
      type: object
      properties:
        status: { type: string, example: SUCCESS }
        code: { type: integer, example: 200 }
        message: { type: string, example: 소멸 임박 스탬프북 조회 성공 }
        data:
          type: array
          items:
            $ref: '#/components/schemas/StampBookExpiringItem'

    StampBookExpiringItem:
      type: object
      properties:
        id:
          type: integer
          description: 스탬프북 ID
          example: 12
        cafe:
          $ref: '#/components/schemas/CafeSummary'
        round:
          type: integer
          description: 진행 회차
          example: 2
        rewardDetail:
          type: string
          description: 스탬프 조건/보상 안내 문구
          example: 스탬프 10개 모으면 아메리카노 한 잔 무료
        goalCount:
          type: integer
          example: 10
        currentCount:
          type: integer
          example: 6
        progressPercent:
          type: integer
          description: 진행률(%) = round(currentCount/goalCount*100), 최대 100
          example: 60
        status:
          type: string
          description: 스탬프북 상태(enum, 소문자)
          enum: [active, expired, completed, converted]
          example: active
        isCompleted:
          type: boolean
          example: false
        expiresAt:
          type: string
          format: date-time
          description: 만료일(UTC)
          example: "2025-08-15T00:00:00.000Z"
        daysUntilExpiration:
          type: integer
          description: KST 00:00 기준 D-day (오늘 0, 음수면 만료)
          example: 3
        isExpiringSoon:
          type: boolean
          description: D-day ≤ 3
          example: true
        previewRewardText:
          type: string
          description: "예: 'n회 후 포인트로 자동 환전돼요!'"
          example: 4회 후 포인트로 자동 환전돼요!
        canExtend:
          type: boolean
          description: 연장 가능 여부(미완료 && 1~7일 남음)
          example: true

    StampConversionResult:
      type: object
      properties:
        stampBookId: { type: integer, example: 12 }
        cafeId: { type: integer, example: 3 }
        cafeName: { type: string, example: 카페 위니 }
        stampCount: { type: integer, example: 5 }
        pointPerStamp: { type: integer, example: 2 }
        pointAmount: { type: integer, example: 10 }
        remainingStampCount: { type: integer, example: 0 }
        convertedAt: { type: string, format: date-time, example: "2025-07-31T09:10:30.000Z" }

    StampConversionSuccessResponse:
      type: object
      properties:
        status: { type: string, example: SUCCESS }
        code: { type: integer, example: 200 }
        message: { type: string, example: "카페 위니의 5개의 스탬프가 10포인트로 환전되었습니다." }
        data:
          $ref: '#/components/schemas/StampConversionResult'

    ConvertedStampBookHistoryByCafeSuccessResponse:
      type: object
      properties:
        status: { type: string, example: SUCCESS }
        code: { type: integer, example: 200 }
        message: { type: string, example: 환전 히스토리(카페별) 조회 성공 }
        data:
          type: array
          description: 카페별 그룹 목록
          items:
            $ref: '#/components/schemas/ConvertedStampBookCafeGroup'

    ConvertedStampBookCafeGroup:
      type: object
      properties:
        cafeId:
          type: integer
          description: 카페 ID
          example: 7
        cafeName:
          type: string
          description: 카페 이름
          example: 블루보틀 연남점
        cafeAddress:
          type: string
          description: 카페 주소
          example: 서울특별시 마포구 연남동 123-45
        cafeImageUrl:
          type: string
          format: uri
          nullable: true
          description: 카페 썸네일 이미지 URL
          example: https://example.com/photo.jpg
        completedCount:
          type: integer
          description: 해당 카페에서 환전 완료된 스탬프북 개수
          example: 2
        items:
          type: array
          description: 해당 카페의 환전 완료 스탬프북 목록
          items:
            $ref: '#/components/schemas/ConvertedStampBookHistoryItem'

    ConvertedStampBookHistoryItem:
      type: object
      properties:
        stampBookId:
          type: integer
          description: 스탬프북 ID
          example: 15
        round:
          type: integer
          description: 해당 카페에서 몇 번째 스탬프북인지(회차)
          example: 3
        completedAt:
          type: string
          format: date-time
          nullable: true
          description: 목표 달성 시각(모두 모았어요)
          example: "2025-07-30T09:00:00.000Z"
        convertedAt:
          type: string
          format: date-time
          description: 환전 완료 시각
          example: "2025-07-31T13:45:00.000Z"
        displayText:
          type: string
          description: 리스트 보조 문구
          example: 스탬프지 3장 완료

      
    TotalStampCountResult:
      type: object
      properties:
        totalStampCount:
          type: integer
          example: 42

    TotalStampCountResponse:
      type: object
      properties:
        status:
          type: string
          example: SUCCESS
        code:
          type: integer
          example: 200
        message:
          type: string
          example: 총 스탬프 수 조회 성공
        data:
          $ref: '#/components/schemas/TotalStampCountResult'

    LoopyLevelResult:
      type: object
      properties:
        stampBookCount:
          type: integer
          example: 8
        level:
          type: integer
          example: 2
        label:
          type: string
          example: 차곡차곡 쌓는 수집가

    LoopyLevelResponse:
      type: object
      properties:
        status:
          type: string
          example: SUCCESS
        code:
          type: integer
          example: 200
        message:
          type: string
          example: 루피 레벨 조회 성공
        data:
          $ref: '#/components/schemas/LoopyLevelResult'

    StampBookExtensionResult:
      type: object
      properties:
        stampBookId:
          type: integer
          example: 12
        expiresAt:
          type: string
          format: date-time
          example: "2025-08-14T00:00:00.000Z"
        extendedAt:
          type: string
          format: date-time
          example: "2025-07-31T10:00:00.000Z"

    StampBookExtensionSuccessResponse:
      type: object
      properties:
        status: { type: string, example: SUCCESS }
        code: { type: integer, example: 200 }
        message: { type: string, example: 스탬프북이 14일 연장되었습니다. }
        data:
          $ref: '#/components/schemas/StampBookExtensionResult'

    SystemNotificationDetail:
      type: object
      properties:
        title:
          type: string
          example: 시스템 알림 제목
        content:
          type: string
          example: 시스템 알림 본문

    ChallengeNotificationDetail:
      type: array
      items:
        type: object
        properties:
          id:
            type: integer
          title:
            type: string
          description:
            type: string
          thumbnailUrl:
            type: string
          startDate:
            type: string
            format: date
          endDate:
            type: string
            format: date
          isActive:
            type: boolean

    StampNotificationDetail:
      type: object
      properties:
        id:
          type: integer
        currentCount:
          type: integer
        goalCount:
          type: integer
        rewardDetail:
          type: string
        status:
          type: string
        isCompleted:
          type: boolean
        isConverted:
          type: boolean
        expiresAt:
          type: string
          format: date-time
        lastVisitedAt:
          type: string
          format: date-time
          nullable: true

    ReviewNotificationDetail:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        address:
          type: string

    CouponNotificationDetail:
      type: array
      items:
        type: object
        properties:
          id:
            type: integer
          name:
            type: string
          validDays:
            type: integer
          discountType:
            type: string
          discountValue:
            type: integer
          applicableMenuId:
            type: integer
            nullable: true
          expiredAt:
            type: string
            format: date-time

    CafeInfo:
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          example: 루피커피
        address:
          type: string
          example: 서울시 성북구 성북로 123

    UserCoupon:
      type: object
      properties:
        id:
          type: integer
          example: 12
        userId:
          type: integer
          example: 3
        couponTemplateId:
          type: integer
          example: 7
        acquisitionType:
          type: string
          enum: [promotion, stamp]
          example: stamp
        status:
          type: string
          enum: [active, used, expired]
          example: active
        issuedAt:
          type: string
          format: date-time
        usedAt:
          type: string
          format: date-time
          nullable: true
        expiredAt:
          type: string
          format: date-time
        couponTemplate:
          $ref: '#/components/schemas/CouponTemplate'
    
    CouponTemplate:
      type: object
      properties:
        id:
          type: integer
          example: 7
        cafeId:
          type: integer
          example: 1
        name:
          type: string
          example: 아메리카노 무료 쿠폰
        discountType:
          type: string
          enum: [DISCOUNT, FREE_DRINK, SIZE_UP]
          description: 쿠폰의 할인 유형
          example: FREE_DRINK
        discountValue:
          type: integer
          nullable: true
          description: DISCOUNT 타입일 경우 할인 금액
          example: 1500
        applicableMenuId:
          type: integer
          nullable: true
          description: FREE_DRINK 또는 SIZE_UP일 경우 적용 대상 메뉴 ID
          example: 3
        validDays:
          type: integer
          nullable: true
          example: 14
        isActive:
          type: boolean
          example: true
        expiredAt:
          type: string
          format: date-time
        createdAt:
          type: string
          format: date-time

    UserByPhoneResponse:
      type: object
      properties:
        status:
          type: string
          example: SUCCESS
        code:
          type: integer
          example: 200
        message:
          type: string
          example: 고객 정보 조회 성공
        data:
          type: object
          properties:
            userId:
              type: integer
              example: 42
            nickname:
              type: string
              example: 별다방단골
            phone:
              type: string
              example: 010-1234-5678
            stamp:
              type: object
              properties:
                totalCount:
                  type: integer
                  description: 누적 스탬프 총 개수
                  example: 18
                currentStampBook:
                  oneOf:
                    - $ref: '#/components/schemas/CurrentStampBookInfo'
                    - type: 'null'
            point:
              type: object
              properties:
                total:
                  type: integer
                  description: Earned 포인트 합계
                  example: 2300
            actionToken:
              type: string
              description: 스탬프 적립 전용 1회용 JWT (약 2분 유효)
              example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
    CurrentStampBookInfo:
      type: object
      properties:
        stampBookId:
          type: integer
          example: 77
        currentCount:
          type: integer
          example: 6
        goalCount:
          type: integer
          example: 10
        progressRate:
          type: integer
          description: 진행률(%) = floor(currentCount/goalCount*100)
          example: 60
        expiresAt:
          type: string
          format: date-time
          example: "2025-08-25T00:00:00.000Z"
        daysLeft:
          type: integer
          description: 만료일까지 남은 일수(D-day)
          example: 14
    phoneErrorResponse:
      type: object
      properties:
        status:
          type: string
          example: FAIL
        code:
          type: integer
          example: 400
        message:
          type: string
          example: 전화번호 입력 누락
        data:
          nullable: true
          example: null

    VerifyQRTokenRequest:
      type: object
      required: [userId]
      properties:
        userId:
          type: integer
          description: 프론트에서 QR 해석 후 전달하는 고객 ID
          example: 123

    UserReviewSummary:
      type: object
      properties:
        reviewId:
          type: integer
          example: 5
        userId:
          type: integer
          example: 1
        cafeId:
          type: integer
          example: 3
        cafeName:
          type: string
          example: 루피커피
        title:
          type: string
          example: "(테스트) 분위기 좋고 커피 맛있는 재방문의사 100% 카페 후기"
        content:
          type: string
          example: "(테스트) 카페에 도착하자마자 느껴지는 따뜻하고 아늑한 분위기..."
        images:
          type: array
          items:
            type: string
            example: "https://loopy-review.s3.amazonaws.com/reviews/12345_image.png"
        createdAt:
          type: string
          format: date-time
          example: 2025-08-01T08:47:04.446Z
          
    VerifyQRTokenSuccessResponse:
      type: object
      properties:
        resultType:
          type: string
          example: SUCCESS
        error:
          type: "null"
          example: null
        success:
          type: object
          properties:
            userId:
              type: integer
            nickname:
              type: string
            stamp:
              type: object
              properties:
                totalCount:
                  type: integer
                  description: 사용자 전체 스탬프 수
                currentStampBook:
                  oneOf:
                    - $ref: '#/components/schemas/CurrentStampBook'
                    - type: "null"
                  description: 현재 카페에서 진행 중인 스탬프북 (없으면 null)
            point:
              type: object
              properties:
                total:
                  type: integer
                  description: EARNED - SPENT
            availableCoupons:
              type: array
              items:
                $ref: '#/components/schemas/AvailableCoupon'
            ongoingChallenges:
              type: array
              items:
                $ref: '#/components/schemas/OngoingChallenge'

    CurrentStampBook:
      type: object
      properties:
        stampBookId: { type: integer }
        currentCount: { type: integer }
        goalCount: { type: integer }

    AvailableCoupon:
      type: object
      properties:
        userCouponId: { type: integer }
        name: { type: string }
        description: { type: string }
        expiredAt:
          type: string
          format: date-time

    OngoingChallenge:
      type: object
      properties:
        challengeId: { type: integer }
        title: { type: string }
        expiredAt:
          type: string
          format: date-time

    UseAllPointsResult:
      type: object
      properties:
        before:
          type: integer
          description: 사용 전 잔액(포인트)
          example: 1200
        usedAmount:
          type: integer
          description: 이번에 사용된 포인트(전액)
          example: 1200
        remaining:
          type: integer
          description: 사용 후 잔액(항상 0)
          example: 0
      
tags:
  - name: Users
    description: 사용자 정보 및 설정 관련 API
